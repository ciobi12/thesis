Loading training volumes...
Loaded: root_volume_000.npy (fg=0.0306%)
Loaded: root_volume_004.npy (fg=0.0493%)
Loaded: root_volume_005.npy (fg=0.0204%)
Loaded: root_volume_007.npy (fg=0.2539%)
Loaded: root_volume_008.npy (fg=0.0558%)
Loaded: root_volume_011.npy (fg=0.0839%)
Loaded: root_volume_013.npy (fg=0.0865%)
Loaded: root_volume_015.npy (fg=0.0407%)
Loaded: root_volume_016.npy (fg=0.1948%)
Loaded: root_volume_018.npy (fg=0.0204%)
Loaded: root_volume_019.npy (fg=0.1778%)

Summary: Loaded 11 volumes
Loaded 11 training volumes

Loading validation volumes...
Loaded: root_volume_001.npy (fg=0.0337%)
Loaded: root_volume_002.npy (fg=0.1398%)
Loaded: root_volume_003.npy (fg=0.0562%)
Loaded: root_volume_006.npy (fg=0.2260%)
Loaded: root_volume_009.npy (fg=0.0204%)
Loaded: root_volume_010.npy (fg=0.0211%)
Loaded: root_volume_012.npy (fg=0.1398%)
Loaded: root_volume_014.npy (fg=0.0204%)
Loaded: root_volume_017.npy (fg=0.0659%)

Summary: Loaded 9 volumes
Loaded 9 validation volumes
Training on device: cuda
Input size: 128x128 -> Using standard network architecture
Network parameters: 668,738

============================================================
Starting DQN training on CT-Like dataset
  - Training volumes: 11
  - Validation volumes: 9
  - Volume shape: (128, 128, 128)
  - Epochs: 20
  - Eval every: 1 epochs
  - Continuity coef: 0.1 (decay: 0.5)
  - Gradient coef: 0.1
  - Manhattan coef: 0.1
  - DICE coefficient: 1.0
  - Data augmentation prob: 0.0
  - Early stopping patience: 100 epochs
============================================================

Epoch 1/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 1/20:   9%|▉         | 1/11 [01:03<10:30, 63.00s/it]Epoch 1/20:  18%|█▊        | 2/11 [02:13<10:08, 67.56s/it]Epoch 1/20:  27%|██▋       | 3/11 [03:24<09:13, 69.13s/it]Epoch 1/20:  36%|███▋      | 4/11 [04:34<08:05, 69.38s/it]Epoch 1/20:  45%|████▌     | 5/11 [05:45<06:58, 69.83s/it]Epoch 1/20:  55%|█████▍    | 6/11 [06:55<05:49, 69.98s/it]Epoch 1/20:  64%|██████▎   | 7/11 [08:05<04:39, 69.94s/it]Epoch 1/20:  73%|███████▎  | 8/11 [09:14<03:28, 69.62s/it]Epoch 1/20:  82%|████████▏ | 9/11 [10:23<02:19, 69.50s/it]Epoch 1/20:  91%|█████████ | 10/11 [11:32<01:09, 69.50s/it]Epoch 1/20: 100%|██████████| 11/11 [12:42<00:00, 69.47s/it]Epoch 1/20: 100%|██████████| 11/11 [12:42<00:00, 69.30s/it]

[Epoch 1] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.001823
Epoch 1/20 | Time: 771.4s | Loss: 0.0065 | ε: 0.973
  Returns - Total: -1275723.39 | Base: -1037871.09 | Cont: -2673.12 | Grad: -234379.01 | DICE: 0.00 | Manhattan: -800.18
Epoch 2/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 2/20:   9%|▉         | 1/11 [01:06<11:04, 66.42s/it]Epoch 2/20:  18%|█▊        | 2/11 [02:15<10:09, 67.77s/it]Epoch 2/20:  27%|██▋       | 3/11 [03:23<09:04, 68.07s/it]Epoch 2/20:  36%|███▋      | 4/11 [04:31<07:54, 67.85s/it]Epoch 2/20:  45%|████▌     | 5/11 [05:37<06:43, 67.17s/it]Epoch 2/20:  55%|█████▍    | 6/11 [06:43<05:34, 66.99s/it]Epoch 2/20:  64%|██████▎   | 7/11 [07:49<04:26, 66.73s/it]Epoch 2/20:  73%|███████▎  | 8/11 [08:56<03:19, 66.64s/it]Epoch 2/20:  82%|████████▏ | 9/11 [10:03<02:13, 66.80s/it]Epoch 2/20:  91%|█████████ | 10/11 [11:08<01:06, 66.28s/it]Epoch 2/20: 100%|██████████| 11/11 [12:14<00:00, 66.13s/it]Epoch 2/20: 100%|██████████| 11/11 [12:14<00:00, 66.76s/it]

[Epoch 2] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.003088
  [EARLY STOPPING] No improvement for 1/100 epochs
Epoch 2/20 | Time: 743.4s | Loss: 0.0079 | ε: 0.946
  Returns - Total: -1290974.72 | Base: -998924.45 | Cont: -6134.16 | Grad: -285143.79 | DICE: 0.00 | Manhattan: -772.31
Epoch 3/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 3/20:   9%|▉         | 1/11 [01:06<11:05, 66.59s/it]Epoch 3/20:  18%|█▊        | 2/11 [02:11<09:51, 65.77s/it]Epoch 3/20:  27%|██▋       | 3/11 [03:17<08:46, 65.82s/it]Epoch 3/20:  36%|███▋      | 4/11 [04:23<07:41, 65.91s/it]Epoch 3/20:  45%|████▌     | 5/11 [05:30<06:36, 66.05s/it]Epoch 3/20:  55%|█████▍    | 6/11 [06:36<05:30, 66.14s/it]Epoch 3/20:  64%|██████▎   | 7/11 [07:42<04:24, 66.05s/it]Epoch 3/20:  73%|███████▎  | 8/11 [08:45<03:15, 65.03s/it]Epoch 3/20:  82%|████████▏ | 9/11 [09:49<02:09, 64.97s/it]Epoch 3/20:  91%|█████████ | 10/11 [10:54<01:04, 64.93s/it]Epoch 3/20: 100%|██████████| 11/11 [11:56<00:00, 64.05s/it]Epoch 3/20: 100%|██████████| 11/11 [11:56<00:00, 65.16s/it]

[Epoch 3] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.003428
  [EARLY STOPPING] No improvement for 2/100 epochs
Epoch 3/20 | Time: 725.6s | Loss: 0.0106 | ε: 0.920
  Returns - Total: -1294689.57 | Base: -978497.00 | Cont: -7937.81 | Grad: -307499.57 | DICE: 0.00 | Manhattan: -755.20
Epoch 4/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 4/20:   9%|▉         | 1/11 [01:04<10:49, 64.90s/it]Epoch 4/20:  18%|█▊        | 2/11 [02:09<09:40, 64.47s/it]Epoch 4/20:  27%|██▋       | 3/11 [03:13<08:36, 64.51s/it]Epoch 4/20:  36%|███▋      | 4/11 [04:15<07:23, 63.30s/it]Epoch 4/20:  45%|████▌     | 5/11 [05:18<06:21, 63.51s/it]Epoch 4/20:  55%|█████▍    | 6/11 [06:21<05:15, 63.18s/it]Epoch 4/20:  64%|██████▎   | 7/11 [07:23<04:10, 62.66s/it]Epoch 4/20:  73%|███████▎  | 8/11 [08:29<03:11, 63.76s/it]Epoch 4/20:  82%|████████▏ | 9/11 [09:30<02:05, 62.85s/it]Epoch 4/20:  91%|█████████ | 10/11 [10:33<01:02, 62.88s/it]Epoch 4/20: 100%|██████████| 11/11 [11:36<00:00, 63.11s/it]Epoch 4/20: 100%|██████████| 11/11 [11:36<00:00, 63.33s/it]

[Epoch 4] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.005337
  [EARLY STOPPING] No improvement for 3/100 epochs
Epoch 4/20 | Time: 705.4s | Loss: 0.0114 | ε: 0.895
  Returns - Total: -1302057.44 | Base: -945359.73 | Cont: -10670.02 | Grad: -345299.78 | DICE: 0.00 | Manhattan: -727.92
Epoch 5/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 5/20:   9%|▉         | 1/11 [01:03<10:38, 63.84s/it]Epoch 5/20:  18%|█▊        | 2/11 [02:08<09:38, 64.28s/it]Epoch 5/20:  27%|██▋       | 3/11 [03:08<08:19, 62.44s/it]Epoch 5/20:  36%|███▋      | 4/11 [04:10<07:16, 62.36s/it]Epoch 5/20:  45%|████▌     | 5/11 [05:15<06:18, 63.15s/it]Epoch 5/20:  55%|█████▍    | 6/11 [06:17<05:14, 62.89s/it]Epoch 5/20:  64%|██████▎   | 7/11 [07:18<04:08, 62.19s/it]Epoch 5/20:  73%|███████▎  | 8/11 [08:20<03:06, 62.04s/it]Epoch 5/20:  82%|████████▏ | 9/11 [09:20<02:02, 61.46s/it]Epoch 5/20:  91%|█████████ | 10/11 [10:24<01:02, 62.22s/it]Epoch 5/20: 100%|██████████| 11/11 [11:22<00:00, 61.04s/it]Epoch 5/20: 100%|██████████| 11/11 [11:22<00:00, 62.07s/it]

[Epoch 5] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.010295
  [EARLY STOPPING] No improvement for 4/100 epochs
Epoch 5/20 | Time: 691.7s | Loss: 0.0148 | ε: 0.870
  Returns - Total: -1302141.94 | Base: -918526.27 | Cont: -12306.04 | Grad: -370602.21 | DICE: 0.00 | Manhattan: -707.42
Epoch 6/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 6/20:   9%|▉         | 1/11 [01:00<10:09, 60.93s/it]Epoch 6/20:  18%|█▊        | 2/11 [02:01<09:08, 60.95s/it]Epoch 6/20:  27%|██▋       | 3/11 [03:03<08:11, 61.43s/it]Epoch 6/20:  36%|███▋      | 4/11 [04:08<07:19, 62.72s/it]Epoch 6/20:  45%|████▌     | 5/11 [05:09<06:13, 62.24s/it]Epoch 6/20:  55%|█████▍    | 6/11 [06:11<05:09, 61.95s/it]Epoch 6/20:  64%|██████▎   | 7/11 [07:14<04:09, 62.33s/it]Epoch 6/20:  73%|███████▎  | 8/11 [08:14<03:05, 61.75s/it]Epoch 6/20:  82%|████████▏ | 9/11 [09:18<02:04, 62.20s/it]Epoch 6/20:  91%|█████████ | 10/11 [10:21<01:02, 62.44s/it]Epoch 6/20: 100%|██████████| 11/11 [11:21<00:00, 61.89s/it]Epoch 6/20: 100%|██████████| 11/11 [11:21<00:00, 61.98s/it]

[Epoch 6] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.015819
  [EARLY STOPPING] No improvement for 5/100 epochs
Epoch 6/20 | Time: 690.6s | Loss: 0.0227 | ε: 0.846
  Returns - Total: -1304090.92 | Base: -911733.73 | Cont: -13051.32 | Grad: -378604.10 | DICE: 0.00 | Manhattan: -701.78
Epoch 7/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 7/20:   9%|▉         | 1/11 [01:01<10:14, 61.40s/it]Epoch 7/20:  18%|█▊        | 2/11 [02:03<09:14, 61.64s/it]Epoch 7/20:  27%|██▋       | 3/11 [03:07<08:23, 62.88s/it]Epoch 7/20:  36%|███▋      | 4/11 [04:07<07:12, 61.77s/it]Epoch 7/20:  45%|████▌     | 5/11 [05:07<06:07, 61.23s/it]Epoch 7/20:  55%|█████▍    | 6/11 [06:04<04:58, 59.80s/it]Epoch 7/20:  64%|██████▎   | 7/11 [07:03<03:57, 59.28s/it]Epoch 7/20:  73%|███████▎  | 8/11 [08:02<02:58, 59.39s/it]Epoch 7/20:  82%|████████▏ | 9/11 [08:58<01:56, 58.19s/it]Epoch 7/20:  91%|█████████ | 10/11 [09:59<00:59, 59.15s/it]Epoch 7/20: 100%|██████████| 11/11 [10:57<00:00, 58.91s/it]Epoch 7/20: 100%|██████████| 11/11 [10:57<00:00, 59.82s/it]

[Epoch 7] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.027662
  [EARLY STOPPING] No improvement for 6/100 epochs
Epoch 7/20 | Time: 666.9s | Loss: 0.0311 | ε: 0.823
  Returns - Total: -1300160.44 | Base: -869357.64 | Cont: -15602.39 | Grad: -414522.35 | DICE: 0.00 | Manhattan: -678.07
Epoch 8/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 8/20:   9%|▉         | 1/11 [00:59<09:50, 59.05s/it]Epoch 8/20:  18%|█▊        | 2/11 [01:59<09:00, 60.06s/it]Epoch 8/20:  27%|██▋       | 3/11 [02:59<08:00, 60.06s/it]Epoch 8/20:  36%|███▋      | 4/11 [04:00<07:02, 60.34s/it]Epoch 8/20:  45%|████▌     | 5/11 [05:00<06:00, 60.11s/it]Epoch 8/20:  55%|█████▍    | 6/11 [06:01<05:02, 60.54s/it]Epoch 8/20:  64%|██████▎   | 7/11 [07:00<04:00, 60.03s/it]Epoch 8/20:  73%|███████▎  | 8/11 [08:00<03:00, 60.03s/it]Epoch 8/20:  82%|████████▏ | 9/11 [08:58<01:58, 59.19s/it]Epoch 8/20:  91%|█████████ | 10/11 [09:56<00:59, 59.09s/it]Epoch 8/20: 100%|██████████| 11/11 [10:53<00:00, 58.40s/it]Epoch 8/20: 100%|██████████| 11/11 [10:53<00:00, 59.43s/it]

[Epoch 8] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.023583
  [EARLY STOPPING] No improvement for 7/100 epochs
Epoch 8/20 | Time: 662.6s | Loss: 0.0381 | ε: 0.800
  Returns - Total: -1296503.98 | Base: -860402.18 | Cont: -16282.53 | Grad: -419151.31 | DICE: 0.00 | Manhattan: -667.96
Epoch 9/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 9/20:   9%|▉         | 1/11 [01:00<10:04, 60.45s/it]Epoch 9/20:  18%|█▊        | 2/11 [02:00<08:59, 59.98s/it]Epoch 9/20:  27%|██▋       | 3/11 [03:01<08:03, 60.44s/it]Epoch 9/20:  36%|███▋      | 4/11 [03:57<06:53, 59.04s/it]Epoch 9/20:  45%|████▌     | 5/11 [04:58<05:57, 59.60s/it]Epoch 9/20:  55%|█████▍    | 6/11 [05:56<04:54, 58.88s/it]Epoch 9/20:  64%|██████▎   | 7/11 [06:54<03:54, 58.70s/it]Epoch 9/20:  73%|███████▎  | 8/11 [07:51<02:54, 58.30s/it]Epoch 9/20:  82%|████████▏ | 9/11 [08:48<01:55, 57.88s/it]Epoch 9/20:  91%|█████████ | 10/11 [09:44<00:57, 57.12s/it]Epoch 9/20: 100%|██████████| 11/11 [10:42<00:00, 57.35s/it]Epoch 9/20: 100%|██████████| 11/11 [10:42<00:00, 58.37s/it]

[Epoch 9] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.036435
  [EARLY STOPPING] No improvement for 8/100 epochs
Epoch 9/20 | Time: 651.0s | Loss: 0.0383 | ε: 0.778
  Returns - Total: -1295758.83 | Base: -839020.36 | Cont: -17448.71 | Grad: -438640.70 | DICE: 0.00 | Manhattan: -649.05
Epoch 10/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 10/20:   9%|▉         | 1/11 [00:53<08:55, 53.57s/it]Epoch 10/20:  18%|█▊        | 2/11 [01:51<08:24, 56.05s/it]Epoch 10/20:  27%|██▋       | 3/11 [02:46<07:25, 55.67s/it]Epoch 10/20:  36%|███▋      | 4/11 [03:44<06:34, 56.36s/it]Epoch 10/20:  45%|████▌     | 5/11 [04:42<05:43, 57.29s/it]Epoch 10/20:  55%|█████▍    | 6/11 [05:39<04:45, 57.03s/it]Epoch 10/20:  64%|██████▎   | 7/11 [06:36<03:47, 56.92s/it]Epoch 10/20:  73%|███████▎  | 8/11 [07:32<02:50, 56.85s/it]Epoch 10/20:  82%|████████▏ | 9/11 [08:28<01:52, 56.35s/it]Epoch 10/20:  91%|█████████ | 10/11 [09:24<00:56, 56.43s/it]Epoch 10/20: 100%|██████████| 11/11 [10:20<00:00, 56.20s/it]Epoch 10/20: 100%|██████████| 11/11 [10:20<00:00, 56.40s/it]

[Epoch 10] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0000 | IoU: 0.0000
  [TRAIN] Precision: 0.0000 | Recall: 0.0000
  [VAL] DICE: 0.0000 | IoU: 0.0000
  [VAL] Precision: 0.0000 | Recall: 0.0000
  [VAL] Loss: 0.049762
  [EARLY STOPPING] No improvement for 9/100 epochs
Epoch 10/20 | Time: 629.3s | Loss: 0.0522 | ε: 0.757
  Returns - Total: -1287533.66 | Base: -800121.64 | Cont: -19577.13 | Grad: -467213.68 | DICE: 0.00 | Manhattan: -621.21
Epoch 11/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 11/20:   9%|▉         | 1/11 [00:56<09:22, 56.21s/it]Epoch 11/20:  18%|█▊        | 2/11 [01:54<08:37, 57.50s/it]Epoch 11/20:  27%|██▋       | 3/11 [02:48<07:28, 56.02s/it]Epoch 11/20:  36%|███▋      | 4/11 [03:42<06:26, 55.15s/it]Epoch 11/20:  45%|████▌     | 5/11 [04:40<05:35, 55.98s/it]Epoch 11/20:  55%|█████▍    | 6/11 [05:36<04:40, 56.05s/it]Epoch 11/20:  64%|██████▎   | 7/11 [06:31<03:42, 55.65s/it]Epoch 11/20:  73%|███████▎  | 8/11 [07:25<02:45, 55.28s/it]Epoch 11/20:  82%|████████▏ | 9/11 [08:19<01:49, 54.97s/it]Epoch 11/20:  91%|█████████ | 10/11 [09:12<00:54, 54.32s/it]Epoch 11/20: 100%|██████████| 11/11 [10:06<00:00, 54.01s/it]Epoch 11/20: 100%|██████████| 11/11 [10:06<00:00, 55.10s/it]

[Epoch 11] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.1562 | IoU: 0.1019
  [TRAIN] Precision: 0.3299 | Recall: 0.1166
  [VAL] DICE: 0.1412 | IoU: 0.0807
  [VAL] Precision: 0.5053 | Recall: 0.0843
  [VAL] Loss: 0.079413
  [EARLY STOPPING] No improvement for 10/100 epochs
  [NEW BEST] Saved best model (val DICE=0.1412)
Epoch 11/20 | Time: 615.4s | Loss: 0.0662 | ε: 0.736
  Returns - Total: -1268252.00 | Base: -773584.00 | Cont: -20494.75 | Grad: -473576.78 | DICE: 0.00 | Manhattan: -596.47
Epoch 12/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 12/20:   9%|▉         | 1/11 [00:58<09:41, 58.18s/it]Epoch 12/20:  18%|█▊        | 2/11 [01:55<08:41, 57.90s/it]Epoch 12/20:  27%|██▋       | 3/11 [02:51<07:35, 56.93s/it]Epoch 12/20:  36%|███▋      | 4/11 [03:44<06:27, 55.30s/it]Epoch 12/20:  45%|████▌     | 5/11 [04:37<05:26, 54.39s/it]Epoch 12/20:  55%|█████▍    | 6/11 [05:30<04:29, 53.95s/it]Epoch 12/20:  64%|██████▎   | 7/11 [06:25<03:37, 54.41s/it]Epoch 12/20:  73%|███████▎  | 8/11 [07:23<02:46, 55.59s/it]Epoch 12/20:  82%|████████▏ | 9/11 [08:21<01:52, 56.22s/it]Epoch 12/20:  91%|█████████ | 10/11 [09:14<00:55, 55.27s/it]Epoch 12/20: 100%|██████████| 11/11 [10:10<00:00, 55.35s/it]Epoch 12/20: 100%|██████████| 11/11 [10:10<00:00, 55.46s/it]

[Epoch 12] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0074 | IoU: 0.0038
  [TRAIN] Precision: 0.1673 | Recall: 0.0038
  [VAL] DICE: 0.0001 | IoU: 0.0000
  [VAL] Precision: 0.0556 | Recall: 0.0000
  [VAL] Loss: 0.094494
  [EARLY STOPPING] No improvement for 11/100 epochs
Epoch 12/20 | Time: 618.9s | Loss: 0.0885 | ε: 0.716
  Returns - Total: -1264150.33 | Base: -783830.36 | Cont: -19811.18 | Grad: -459899.82 | DICE: 0.00 | Manhattan: -608.98
Epoch 13/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 13/20:   9%|▉         | 1/11 [00:55<09:15, 55.59s/it]Epoch 13/20:  18%|█▊        | 2/11 [01:50<08:14, 54.90s/it]Epoch 13/20:  27%|██▋       | 3/11 [02:37<06:51, 51.46s/it]Epoch 13/20:  36%|███▋      | 4/11 [03:31<06:07, 52.44s/it]Epoch 13/20:  45%|████▌     | 5/11 [04:28<05:24, 54.04s/it]Epoch 13/20:  55%|█████▍    | 6/11 [05:23<04:32, 54.58s/it]Epoch 13/20:  64%|██████▎   | 7/11 [06:16<03:36, 54.09s/it]Epoch 13/20:  73%|███████▎  | 8/11 [07:09<02:41, 53.72s/it]Epoch 13/20:  82%|████████▏ | 9/11 [08:00<01:45, 52.76s/it]Epoch 13/20:  91%|█████████ | 10/11 [08:56<00:53, 53.90s/it]Epoch 13/20: 100%|██████████| 11/11 [09:46<00:00, 52.65s/it]Epoch 13/20: 100%|██████████| 11/11 [09:46<00:00, 53.34s/it]

[Epoch 13] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0705 | IoU: 0.0410
  [TRAIN] Precision: 0.3963 | Recall: 0.0429
  [VAL] DICE: 0.0270 | IoU: 0.0139
  [VAL] Precision: 0.6265 | Recall: 0.0139
  [VAL] Loss: 0.102691
  [EARLY STOPPING] No improvement for 12/100 epochs
Epoch 13/20 | Time: 595.7s | Loss: 0.1168 | ε: 0.697
  Returns - Total: -1252083.06 | Base: -742220.82 | Cont: -21763.04 | Grad: -487519.81 | DICE: 0.00 | Manhattan: -579.40
Epoch 14/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 14/20:   9%|▉         | 1/11 [00:54<09:01, 54.14s/it]Epoch 14/20:  18%|█▊        | 2/11 [01:44<07:46, 51.87s/it]Epoch 14/20:  27%|██▋       | 3/11 [02:38<07:04, 53.04s/it]Epoch 14/20:  36%|███▋      | 4/11 [03:32<06:13, 53.42s/it]Epoch 14/20:  45%|████▌     | 5/11 [04:26<05:19, 53.32s/it]Epoch 14/20:  55%|█████▍    | 6/11 [05:20<04:29, 53.82s/it]Epoch 14/20:  64%|██████▎   | 7/11 [06:13<03:33, 53.46s/it]Epoch 14/20:  73%|███████▎  | 8/11 [07:05<02:38, 52.98s/it]Epoch 14/20:  82%|████████▏ | 9/11 [08:00<01:47, 53.55s/it]Epoch 14/20:  91%|█████████ | 10/11 [08:51<00:52, 52.70s/it]Epoch 14/20: 100%|██████████| 11/11 [09:40<00:00, 51.79s/it]Epoch 14/20: 100%|██████████| 11/11 [09:40<00:00, 52.80s/it]

[Epoch 14] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0870 | IoU: 0.0521
  [TRAIN] Precision: 0.3654 | Recall: 0.0556
  [VAL] DICE: 0.0444 | IoU: 0.0232
  [VAL] Precision: 0.5119 | Recall: 0.0234
  [VAL] Loss: 0.138893
  [EARLY STOPPING] No improvement for 13/100 epochs
Epoch 14/20 | Time: 589.9s | Loss: 0.1239 | ε: 0.677
  Returns - Total: -1247733.94 | Base: -730546.73 | Cont: -23079.22 | Grad: -493541.34 | DICE: 0.00 | Manhattan: -566.65
Epoch 15/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 15/20:   9%|▉         | 1/11 [00:51<08:34, 51.49s/it]Epoch 15/20:  18%|█▊        | 2/11 [01:40<07:28, 49.78s/it]Epoch 15/20:  27%|██▋       | 3/11 [02:30<06:42, 50.28s/it]Epoch 15/20:  36%|███▋      | 4/11 [03:20<05:49, 49.91s/it]Epoch 15/20:  45%|████▌     | 5/11 [04:13<05:06, 51.05s/it]Epoch 15/20:  55%|█████▍    | 6/11 [05:04<04:15, 51.00s/it]Epoch 15/20:  64%|██████▎   | 7/11 [05:56<03:25, 51.28s/it]Epoch 15/20:  73%|███████▎  | 8/11 [06:47<02:33, 51.17s/it]Epoch 15/20:  82%|████████▏ | 9/11 [07:37<01:42, 51.06s/it]Epoch 15/20:  91%|█████████ | 10/11 [08:27<00:50, 50.65s/it]Epoch 15/20: 100%|██████████| 11/11 [09:16<00:00, 50.11s/it]Epoch 15/20: 100%|██████████| 11/11 [09:16<00:00, 50.59s/it]

[Epoch 15] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.1323 | IoU: 0.0844
  [TRAIN] Precision: 0.3192 | Recall: 0.0975
  [VAL] DICE: 0.0998 | IoU: 0.0547
  [VAL] Precision: 0.4712 | Recall: 0.0565
  [VAL] Loss: 0.157042
  [EARLY STOPPING] No improvement for 14/100 epochs
Epoch 15/20 | Time: 565.7s | Loss: 0.1312 | ε: 0.659
  Returns - Total: -1216224.61 | Base: -688886.91 | Cont: -24065.38 | Grad: -502736.52 | DICE: 0.00 | Manhattan: -535.79
Epoch 16/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 16/20:   9%|▉         | 1/11 [00:47<07:53, 47.37s/it]Epoch 16/20:  18%|█▊        | 2/11 [01:34<07:04, 47.22s/it]Epoch 16/20:  27%|██▋       | 3/11 [02:22<06:21, 47.73s/it]Epoch 16/20:  36%|███▋      | 4/11 [03:16<05:49, 49.89s/it]Epoch 16/20:  45%|████▌     | 5/11 [04:07<05:03, 50.60s/it]Epoch 16/20:  55%|█████▍    | 6/11 [04:59<04:14, 50.98s/it]Epoch 16/20:  64%|██████▎   | 7/11 [05:47<03:20, 50.07s/it]Epoch 16/20:  73%|███████▎  | 8/11 [06:38<02:31, 50.42s/it]Epoch 16/20:  82%|████████▏ | 9/11 [07:31<01:41, 50.95s/it]Epoch 16/20:  91%|█████████ | 10/11 [08:21<00:50, 50.75s/it]Epoch 16/20: 100%|██████████| 11/11 [09:07<00:00, 49.34s/it]Epoch 16/20: 100%|██████████| 11/11 [09:07<00:00, 49.78s/it]

[Epoch 16] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.0972 | IoU: 0.0593
  [TRAIN] Precision: 0.3578 | Recall: 0.0638
  [VAL] DICE: 0.0608 | IoU: 0.0324
  [VAL] Precision: 0.5166 | Recall: 0.0328
  [VAL] Loss: 0.164859
  [EARLY STOPPING] No improvement for 15/100 epochs
Epoch 16/20 | Time: 556.5s | Loss: 0.1569 | ε: 0.641
  Returns - Total: -1193696.96 | Base: -669557.91 | Cont: -24190.83 | Grad: -499431.79 | DICE: 0.00 | Manhattan: -516.43
Epoch 17/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 17/20:   9%|▉         | 1/11 [00:51<08:35, 51.54s/it]Epoch 17/20:  18%|█▊        | 2/11 [01:40<07:31, 50.14s/it]Epoch 17/20:  27%|██▋       | 3/11 [02:30<06:40, 50.05s/it]Epoch 17/20:  36%|███▋      | 4/11 [03:23<05:57, 51.01s/it]Epoch 17/20:  45%|████▌     | 5/11 [04:13<05:04, 50.74s/it]Epoch 17/20:  55%|█████▍    | 6/11 [05:05<04:15, 51.19s/it]Epoch 17/20:  64%|██████▎   | 7/11 [05:55<03:23, 50.86s/it]Epoch 17/20:  73%|███████▎  | 8/11 [06:45<02:31, 50.61s/it]Epoch 17/20:  82%|████████▏ | 9/11 [07:32<01:38, 49.41s/it]Epoch 17/20:  91%|█████████ | 10/11 [08:22<00:49, 49.48s/it]Epoch 17/20: 100%|██████████| 11/11 [09:10<00:00, 49.25s/it]Epoch 17/20: 100%|██████████| 11/11 [09:10<00:00, 50.08s/it]

[Epoch 17] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.1146 | IoU: 0.0717
  [TRAIN] Precision: 0.3440 | Recall: 0.0789
  [VAL] DICE: 0.0815 | IoU: 0.0441
  [VAL] Precision: 0.4999 | Recall: 0.0450
  [VAL] Loss: 0.160996
  [EARLY STOPPING] No improvement for 16/100 epochs
Epoch 17/20 | Time: 560.0s | Loss: 0.1717 | ε: 0.623
  Returns - Total: -1196485.36 | Base: -674877.82 | Cont: -24586.76 | Grad: -496495.41 | DICE: 0.00 | Manhattan: -525.36
Epoch 18/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 18/20:   9%|▉         | 1/11 [00:45<07:33, 45.34s/it]Epoch 18/20:  18%|█▊        | 2/11 [01:30<06:48, 45.42s/it]Epoch 18/20:  27%|██▋       | 3/11 [02:21<06:24, 48.01s/it]Epoch 18/20:  36%|███▋      | 4/11 [03:04<05:22, 46.06s/it]Epoch 18/20:  45%|████▌     | 5/11 [03:53<04:41, 46.97s/it]Epoch 18/20:  55%|█████▍    | 6/11 [04:37<03:49, 45.84s/it]Epoch 18/20:  64%|██████▎   | 7/11 [05:27<03:09, 47.30s/it]Epoch 18/20:  73%|███████▎  | 8/11 [06:17<02:24, 48.30s/it]Epoch 18/20:  82%|████████▏ | 9/11 [07:05<01:36, 48.02s/it]Epoch 18/20:  91%|█████████ | 10/11 [07:53<00:48, 48.10s/it]Epoch 18/20: 100%|██████████| 11/11 [08:41<00:00, 48.02s/it]Epoch 18/20: 100%|██████████| 11/11 [08:41<00:00, 47.41s/it]

[Epoch 18] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.1030 | IoU: 0.0632
  [TRAIN] Precision: 0.3616 | Recall: 0.0676
  [VAL] DICE: 0.0687 | IoU: 0.0372
  [VAL] Precision: 0.5111 | Recall: 0.0377
  [VAL] Loss: 0.206331
  [EARLY STOPPING] No improvement for 17/100 epochs
Epoch 18/20 | Time: 530.7s | Loss: 0.2053 | ε: 0.606
  Returns - Total: -1161047.14 | Base: -622758.55 | Cont: -26086.39 | Grad: -511726.71 | DICE: 0.00 | Manhattan: -475.49
Epoch 19/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 19/20:   9%|▉         | 1/11 [00:47<07:58, 47.82s/it]Epoch 19/20:  18%|█▊        | 2/11 [01:34<07:03, 47.05s/it]Epoch 19/20:  27%|██▋       | 3/11 [02:22<06:22, 47.79s/it]Epoch 19/20:  36%|███▋      | 4/11 [03:11<05:36, 48.14s/it]Epoch 19/20:  45%|████▌     | 5/11 [04:01<04:52, 48.81s/it]Epoch 19/20:  55%|█████▍    | 6/11 [04:52<04:06, 49.35s/it]Epoch 19/20:  64%|██████▎   | 7/11 [05:36<03:10, 47.67s/it]Epoch 19/20:  73%|███████▎  | 8/11 [06:20<02:19, 46.44s/it]Epoch 19/20:  82%|████████▏ | 9/11 [07:04<01:31, 45.86s/it]Epoch 19/20:  91%|█████████ | 10/11 [07:50<00:45, 45.95s/it]Epoch 19/20: 100%|██████████| 11/11 [08:39<00:00, 46.68s/it]Epoch 19/20: 100%|██████████| 11/11 [08:39<00:00, 47.20s/it]

[Epoch 19] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.1609 | IoU: 0.1060
  [TRAIN] Precision: 0.3317 | Recall: 0.1222
  [VAL] DICE: 0.1501 | IoU: 0.0861
  [VAL] Precision: 0.4992 | Recall: 0.0903
  [VAL] Loss: 0.312128
  [EARLY STOPPING] No improvement for 18/100 epochs
  [NEW BEST] Saved best model (val DICE=0.1501)
Epoch 19/20 | Time: 528.6s | Loss: 0.2306 | ε: 0.590
  Returns - Total: -1147255.84 | Base: -617444.82 | Cont: -25449.71 | Grad: -503885.84 | DICE: 0.00 | Manhattan: -475.47
Epoch 20/20:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 20/20:   9%|▉         | 1/11 [00:44<07:21, 44.17s/it]Epoch 20/20:  18%|█▊        | 2/11 [01:32<07:01, 46.84s/it]Epoch 20/20:  27%|██▋       | 3/11 [02:16<06:02, 45.33s/it]Epoch 20/20:  36%|███▋      | 4/11 [03:01<05:17, 45.33s/it]Epoch 20/20:  45%|████▌     | 5/11 [03:47<04:33, 45.59s/it]Epoch 20/20:  55%|█████▍    | 6/11 [04:36<03:52, 46.56s/it]Epoch 20/20:  64%|██████▎   | 7/11 [05:24<03:07, 46.97s/it]Epoch 20/20:  73%|███████▎  | 8/11 [06:10<02:20, 46.68s/it]Epoch 20/20:  82%|████████▏ | 9/11 [07:01<01:36, 48.24s/it]Epoch 20/20:  91%|█████████ | 10/11 [07:51<00:48, 48.69s/it]Epoch 20/20: 100%|██████████| 11/11 [08:37<00:00, 48.02s/it]Epoch 20/20: 100%|██████████| 11/11 [08:37<00:00, 47.09s/it]

[Epoch 20] Evaluating on train and validation sets...
  [TRAIN] DICE: 0.1234 | IoU: 0.0772
  [TRAIN] Precision: 0.3729 | Recall: 0.0821
  [VAL] DICE: 0.1017 | IoU: 0.0563
  [VAL] Precision: 0.5524 | Recall: 0.0573
  [VAL] Loss: 0.329943
  [EARLY STOPPING] No improvement for 19/100 epochs
Epoch 20/20 | Time: 527.0s | Loss: 0.3100 | ε: 0.574
  Returns - Total: -1151934.77 | Base: -617474.27 | Cont: -25861.30 | Grad: -508123.92 | DICE: 0.00 | Manhattan: -475.27

============================================================
FINAL EVALUATION
============================================================
Final Train DICE: 0.1234
Final Train IoU:  0.0772
Final Val DICE: 0.1017
Final Val IoU:  0.0563

Training complete. Results saved to: results/ct_like_full/cont_0.1_grad_0.1_manh_0.1
Best validation DICE: 0.1501 (epoch 19)
