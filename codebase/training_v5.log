2025-12-24 22:05:42,887 - INFO - Device: cuda
2025-12-24 22:05:42,887 - INFO - Train: vol=['week2-joint_contrast.nii'], mask=['week2-joint-root-class.nii.gz']
2025-12-24 22:05:42,887 - INFO - Val: vol=['week3-joint_contrast.nii'], mask=['week3-joint-root-class.nii.gz']
2025-12-24 22:05:44,592 - INFO - Train: (800, 466, 471), fg=0.0217%
2025-12-24 22:05:44,627 - INFO - Val: (800, 466, 471), fg=0.0527%
2025-12-24 22:10:42,336 - INFO - Model params: 1,927,618
2025-12-24 22:10:43,075 - INFO - Starting training: Namespace(train_dir='data/rapids-p/train', val_dir='data/rapids-p/val', epochs=100, episodes_per_epoch=20, slices_per_episode=64, batch_size=16, lr=0.0003, gamma=0.95, buffer_capacity=50000, start_epsilon=1.0, end_epsilon=0.05, warmup_epochs=5, history_len=3, base_channels=32, target_update_every=200, dice_coef=1.0, recall_coef=0.8, precision_coef=0.5, shape_coef=0.3, intensity_coef=0.2, continuity_coef=0.1, boundary_coef=0.2, max_avg_width=8.0, roi_dilation=15, use_patches=True, patch_size=128, patch_jitter=20, save_dir='dqn_slice_based/models', seed=42)
2025-12-24 22:12:52,725 - INFO - Epoch 1/100 | Loss: 0.3273 | IoU: 0.0011 | Dice: 0.0022 | Prec: 0.0011 | Rec: 0.8033 | CC: 126245 | Eps: 1.000 | Time: 129.6s
2025-12-24 22:12:52,726 - INFO -   Rewards: dice=0.003, rec=0.546, prec=0.002, shape=0.950, int=0.203, cont=0.992, bound=0.695
2025-12-24 22:12:52,774 - INFO -   New best IoU: 0.0011
2025-12-24 22:15:02,379 - INFO - Epoch 2/100 | Loss: 1.3211 | IoU: 0.0000 | Dice: 0.0000 | Prec: 0.0000 | Rec: 0.0000 | CC: 54094 | Eps: 1.000 | Time: 128.9s
2025-12-24 22:15:02,380 - INFO -   Rewards: dice=0.003, rec=0.555, prec=0.001, shape=0.950, int=0.193, cont=0.992, bound=0.702
2025-12-24 22:17:10,278 - INFO - Epoch 3/100 | Loss: 2.2187 | IoU: 0.0000 | Dice: 0.0000 | Prec: 0.0000 | Rec: 0.0002 | CC: 16722 | Eps: 1.000 | Time: 127.9s
2025-12-24 22:17:10,279 - INFO -   Rewards: dice=0.003, rec=0.544, prec=0.002, shape=0.950, int=0.225, cont=0.992, bound=0.729
2025-12-24 22:19:19,102 - INFO - Epoch 4/100 | Loss: 3.6483 | IoU: 0.0000 | Dice: 0.0000 | Prec: 0.0000 | Rec: 0.0029 | CC: 30638 | Eps: 1.000 | Time: 128.8s
2025-12-24 22:19:19,104 - INFO -   Rewards: dice=0.003, rec=0.556, prec=0.001, shape=0.950, int=0.209, cont=0.992, bound=0.717
2025-12-24 22:21:29,467 - INFO - Epoch 5/100 | Loss: 7.7732 | IoU: 0.0007 | Dice: 0.0013 | Prec: 0.0007 | Rec: 0.9983 | CC: 58520 | Eps: 1.000 | Time: 130.4s
2025-12-24 22:21:29,468 - INFO -   Rewards: dice=0.004, rec=0.568, prec=0.002, shape=0.950, int=0.254, cont=0.992, bound=0.734
2025-12-24 22:23:38,633 - INFO - Epoch 6/100 | Loss: 5.6394 | IoU: 0.0007 | Dice: 0.0013 | Prec: 0.0007 | Rec: 0.9783 | CC: 4748 | Eps: 1.000 | Time: 129.2s
2025-12-24 22:23:38,634 - INFO -   Rewards: dice=0.005, rec=0.530, prec=0.003, shape=0.950, int=0.245, cont=0.992, bound=0.749
2025-12-24 22:25:48,690 - INFO - Epoch 7/100 | Loss: 2.6786 | IoU: 0.0006 | Dice: 0.0012 | Prec: 0.0006 | Rec: 1.0000 | CC: 1 | Eps: 0.980 | Time: 130.1s
2025-12-24 22:25:48,692 - INFO -   Rewards: dice=0.006, rec=0.553, prec=0.003, shape=0.937, int=0.265, cont=0.987, bound=0.755
2025-12-24 22:27:57,559 - INFO - Epoch 8/100 | Loss: 1.7458 | IoU: 0.0010 | Dice: 0.0020 | Prec: 0.0010 | Rec: 0.9534 | CC: 15502 | Eps: 0.960 | Time: 128.9s
2025-12-24 22:27:57,560 - INFO -   Rewards: dice=0.004, rec=0.554, prec=0.002, shape=0.924, int=0.218, cont=0.982, bound=0.710
2025-12-24 22:30:01,731 - INFO - Epoch 9/100 | Loss: 3.2072 | IoU: 0.0036 | Dice: 0.0072 | Prec: 0.0036 | Rec: 0.9584 | CC: 32914 | Eps: 0.941 | Time: 124.2s
2025-12-24 22:30:01,732 - INFO -   Rewards: dice=0.005, rec=0.571, prec=0.002, shape=0.917, int=0.245, cont=0.975, bound=0.739
2025-12-24 22:30:01,797 - INFO -   New best IoU: 0.0036
2025-12-24 22:32:05,364 - INFO - Epoch 10/100 | Loss: 3.2400 | IoU: 0.0006 | Dice: 0.0012 | Prec: 0.0006 | Rec: 1.0000 | CC: 18 | Eps: 0.922 | Time: 123.6s
2025-12-24 22:32:05,366 - INFO -   Rewards: dice=0.004, rec=0.581, prec=0.002, shape=0.900, int=0.212, cont=0.971, bound=0.713
2025-12-24 22:34:09,155 - INFO - Epoch 11/100 | Loss: 1.9952 | IoU: 0.0006 | Dice: 0.0012 | Prec: 0.0006 | Rec: 1.0000 | CC: 29 | Eps: 0.903 | Time: 123.2s
2025-12-24 22:34:09,156 - INFO -   Rewards: dice=0.004, rec=0.596, prec=0.002, shape=0.899, int=0.204, cont=0.971, bound=0.714
2025-12-24 22:36:12,341 - INFO - Epoch 12/100 | Loss: 2.6013 | IoU: 0.0006 | Dice: 0.0012 | Prec: 0.0006 | Rec: 0.5752 | CC: 757 | Eps: 0.884 | Time: 123.2s
2025-12-24 22:36:12,342 - INFO -   Rewards: dice=0.004, rec=0.599, prec=0.002, shape=0.909, int=0.225, cont=0.962, bound=0.701
2025-12-24 22:38:15,360 - INFO - Epoch 13/100 | Loss: 4.9364 | IoU: 0.0006 | Dice: 0.0011 | Prec: 0.0006 | Rec: 0.5118 | CC: 4611 | Eps: 0.865 | Time: 123.0s
2025-12-24 22:38:15,361 - INFO -   Rewards: dice=0.005, rec=0.556, prec=0.002, shape=0.894, int=0.236, cont=0.957, bound=0.748
2025-12-24 22:40:19,039 - INFO - Epoch 14/100 | Loss: 5.5863 | IoU: 0.0004 | Dice: 0.0008 | Prec: 0.0004 | Rec: 0.3769 | CC: 5174 | Eps: 0.847 | Time: 123.7s
2025-12-24 22:40:19,040 - INFO -   Rewards: dice=0.003, rec=0.561, prec=0.002, shape=0.874, int=0.220, cont=0.947, bound=0.723
2025-12-24 22:42:23,762 - INFO - Epoch 15/100 | Loss: 7.0604 | IoU: 0.0006 | Dice: 0.0011 | Prec: 0.0006 | Rec: 0.2977 | CC: 11771 | Eps: 0.829 | Time: 124.7s
2025-12-24 22:42:23,764 - INFO -   Rewards: dice=0.005, rec=0.620, prec=0.002, shape=0.864, int=0.247, cont=0.938, bound=0.733
2025-12-24 22:44:29,728 - INFO - Epoch 16/100 | Loss: 8.1686 | IoU: 0.0005 | Dice: 0.0010 | Prec: 0.0005 | Rec: 0.3900 | CC: 2122 | Eps: 0.811 | Time: 126.0s
2025-12-24 22:44:29,729 - INFO -   Rewards: dice=0.006, rec=0.513, prec=0.022, shape=0.865, int=0.255, cont=0.868, bound=0.726
2025-12-24 22:46:39,053 - INFO - Epoch 17/100 | Loss: 6.2194 | IoU: 0.0005 | Dice: 0.0009 | Prec: 0.0005 | Rec: 0.2227 | CC: 34071 | Eps: 0.793 | Time: 129.3s
2025-12-24 22:46:39,054 - INFO -   Rewards: dice=0.005, rec=0.630, prec=0.002, shape=0.830, int=0.216, cont=0.930, bound=0.745
2025-12-24 22:48:50,433 - INFO - Epoch 18/100 | Loss: 7.8091 | IoU: 0.0006 | Dice: 0.0011 | Prec: 0.0006 | Rec: 0.3307 | CC: 17794 | Eps: 0.775 | Time: 131.4s
2025-12-24 22:48:50,434 - INFO -   Rewards: dice=0.007, rec=0.569, prec=0.004, shape=0.842, int=0.258, cont=0.924, bound=0.745
2025-12-24 22:50:56,736 - INFO - Epoch 19/100 | Loss: 9.2144 | IoU: 0.0006 | Dice: 0.0012 | Prec: 0.0006 | Rec: 0.5004 | CC: 96540 | Eps: 0.758 | Time: 126.3s
2025-12-24 22:50:56,738 - INFO -   Rewards: dice=0.006, rec=0.605, prec=0.003, shape=0.899, int=0.253, cont=0.887, bound=0.741
2025-12-24 22:53:03,671 - INFO - Epoch 20/100 | Loss: 29.4627 | IoU: 0.0003 | Dice: 0.0007 | Prec: 0.0003 | Rec: 0.3140 | CC: 1601 | Eps: 0.741 | Time: 126.9s
2025-12-24 22:53:03,672 - INFO -   Rewards: dice=0.003, rec=0.516, prec=0.001, shape=0.825, int=0.252, cont=0.911, bound=0.747
2025-12-24 22:55:11,620 - INFO - Epoch 21/100 | Loss: 5.3533 | IoU: 0.0006 | Dice: 0.0012 | Prec: 0.0006 | Rec: 0.5635 | CC: 820 | Eps: 0.724 | Time: 127.3s
2025-12-24 22:55:11,622 - INFO -   Rewards: dice=0.003, rec=0.517, prec=0.001, shape=0.751, int=0.251, cont=0.914, bound=0.718
2025-12-24 22:57:18,356 - INFO - Epoch 22/100 | Loss: 6.9745 | IoU: 0.0018 | Dice: 0.0036 | Prec: 0.0018 | Rec: 0.7154 | CC: 3710 | Eps: 0.707 | Time: 126.7s
2025-12-24 22:57:18,357 - INFO -   Rewards: dice=0.005, rec=0.649, prec=0.003, shape=0.900, int=0.221, cont=0.888, bound=0.722
2025-12-24 22:59:22,008 - INFO - Epoch 23/100 | Loss: 8.2647 | IoU: 0.0006 | Dice: 0.0011 | Prec: 0.0006 | Rec: 0.4012 | CC: 309 | Eps: 0.690 | Time: 123.6s
2025-12-24 22:59:22,009 - INFO -   Rewards: dice=0.006, rec=0.599, prec=0.003, shape=0.832, int=0.264, cont=0.892, bound=0.738
2025-12-24 23:01:42,398 - INFO - Epoch 24/100 | Loss: 5.2664 | IoU: 0.0022 | Dice: 0.0043 | Prec: 0.0022 | Rec: 0.8911 | CC: 37249 | Eps: 0.674 | Time: 140.4s
2025-12-24 23:01:42,400 - INFO -   Rewards: dice=0.007, rec=0.671, prec=0.003, shape=0.795, int=0.253, cont=0.900, bound=0.748
2025-12-24 23:03:51,747 - INFO - Epoch 25/100 | Loss: 10.2399 | IoU: 0.0011 | Dice: 0.0021 | Prec: 0.0011 | Rec: 0.3614 | CC: 9080 | Eps: 0.658 | Time: 129.3s
2025-12-24 23:03:51,748 - INFO -   Rewards: dice=0.008, rec=0.645, prec=0.004, shape=0.935, int=0.237, cont=0.845, bound=0.725
2025-12-24 23:05:56,540 - INFO - Epoch 26/100 | Loss: 9.2411 | IoU: 0.0010 | Dice: 0.0020 | Prec: 0.0010 | Rec: 0.3833 | CC: 4370 | Eps: 0.642 | Time: 124.8s
2025-12-24 23:05:56,541 - INFO -   Rewards: dice=0.004, rec=0.517, prec=0.002, shape=0.859, int=0.231, cont=0.860, bound=0.728
2025-12-24 23:08:03,681 - INFO - Epoch 27/100 | Loss: 49.0408 | IoU: 0.0014 | Dice: 0.0028 | Prec: 0.0014 | Rec: 0.4106 | CC: 13315 | Eps: 0.626 | Time: 127.1s
2025-12-24 23:08:03,682 - INFO -   Rewards: dice=0.009, rec=0.537, prec=0.005, shape=0.900, int=0.250, cont=0.794, bound=0.771
2025-12-24 23:10:10,823 - INFO - Epoch 28/100 | Loss: 77.8805 | IoU: 0.0012 | Dice: 0.0023 | Prec: 0.0012 | Rec: 0.3329 | CC: 86067 | Eps: 0.611 | Time: 127.1s
2025-12-24 23:10:10,824 - INFO -   Rewards: dice=0.006, rec=0.603, prec=0.003, shape=0.939, int=0.263, cont=0.803, bound=0.746
2025-12-24 23:12:13,879 - INFO - Epoch 29/100 | Loss: 185.1498 | IoU: 0.0013 | Dice: 0.0025 | Prec: 0.0013 | Rec: 0.1613 | CC: 28417 | Eps: 0.596 | Time: 123.1s
2025-12-24 23:12:13,881 - INFO -   Rewards: dice=0.007, rec=0.528, prec=0.004, shape=0.945, int=0.254, cont=0.759, bound=0.743
2025-12-24 23:14:23,845 - INFO - Epoch 30/100 | Loss: 147.1193 | IoU: 0.0004 | Dice: 0.0008 | Prec: 0.0004 | Rec: 0.1404 | CC: 11495 | Eps: 0.581 | Time: 130.0s
2025-12-24 23:14:23,846 - INFO -   Rewards: dice=0.004, rec=0.382, prec=0.002, shape=0.944, int=0.240, cont=0.771, bound=0.721
2025-12-24 23:16:34,481 - INFO - Epoch 31/100 | Loss: 4.7203 | IoU: 0.0012 | Dice: 0.0025 | Prec: 0.0012 | Rec: 0.3129 | CC: 18039 | Eps: 0.566 | Time: 130.0s
2025-12-24 23:16:34,483 - INFO -   Rewards: dice=0.003, rec=0.437, prec=0.002, shape=0.941, int=0.259, cont=0.815, bound=0.726
2025-12-24 23:18:35,560 - INFO - Epoch 32/100 | Loss: 2.1709 | IoU: 0.0010 | Dice: 0.0020 | Prec: 0.0010 | Rec: 0.7105 | CC: 1211953 | Eps: 0.551 | Time: 121.1s
2025-12-24 23:18:35,561 - INFO -   Rewards: dice=0.004, rec=0.488, prec=0.002, shape=0.962, int=0.249, cont=0.832, bound=0.737
2025-12-24 23:20:40,908 - INFO - Epoch 33/100 | Loss: 2.7672 | IoU: 0.0010 | Dice: 0.0020 | Prec: 0.0010 | Rec: 0.8284 | CC: 20801 | Eps: 0.537 | Time: 125.3s
2025-12-24 23:20:40,910 - INFO -   Rewards: dice=0.007, rec=0.545, prec=0.004, shape=0.938, int=0.242, cont=0.854, bound=0.747
2025-12-24 23:22:48,179 - INFO - Epoch 34/100 | Loss: 4.1013 | IoU: 0.0017 | Dice: 0.0034 | Prec: 0.0017 | Rec: 0.9153 | CC: 27333 | Eps: 0.523 | Time: 127.3s
2025-12-24 23:22:48,180 - INFO -   Rewards: dice=0.006, rec=0.731, prec=0.003, shape=0.879, int=0.232, cont=0.910, bound=0.723
2025-12-24 23:24:50,975 - INFO - Epoch 35/100 | Loss: 5.8615 | IoU: 0.0062 | Dice: 0.0123 | Prec: 0.0062 | Rec: 0.8865 | CC: 11141 | Eps: 0.509 | Time: 122.8s
2025-12-24 23:24:50,976 - INFO -   Rewards: dice=0.006, rec=0.729, prec=0.003, shape=0.885, int=0.245, cont=0.879, bound=0.741
2025-12-24 23:24:51,057 - INFO -   New best IoU: 0.0062
2025-12-24 23:26:54,179 - INFO - Epoch 36/100 | Loss: 6.0380 | IoU: 0.0031 | Dice: 0.0063 | Prec: 0.0031 | Rec: 0.9313 | CC: 61573 | Eps: 0.495 | Time: 123.1s
2025-12-24 23:26:54,180 - INFO -   Rewards: dice=0.005, rec=0.766, prec=0.003, shape=0.916, int=0.218, cont=0.847, bound=0.712
2025-12-24 23:29:02,171 - INFO - Epoch 37/100 | Loss: 8.1782 | IoU: 0.0015 | Dice: 0.0030 | Prec: 0.0015 | Rec: 0.9376 | CC: 78535 | Eps: 0.481 | Time: 128.0s
2025-12-24 23:29:02,172 - INFO -   Rewards: dice=0.005, rec=0.754, prec=0.002, shape=0.854, int=0.216, cont=0.909, bound=0.719
2025-12-24 23:31:08,007 - INFO - Epoch 38/100 | Loss: 51.7361 | IoU: 0.0026 | Dice: 0.0051 | Prec: 0.0026 | Rec: 0.8923 | CC: 5894 | Eps: 0.468 | Time: 125.8s
2025-12-24 23:31:08,008 - INFO -   Rewards: dice=0.008, rec=0.730, prec=0.004, shape=0.906, int=0.234, cont=0.832, bound=0.745
2025-12-24 23:33:11,799 - INFO - Epoch 39/100 | Loss: 8.8739 | IoU: 0.0078 | Dice: 0.0155 | Prec: 0.0078 | Rec: 0.8486 | CC: 21535 | Eps: 0.455 | Time: 123.8s
2025-12-24 23:33:11,801 - INFO -   Rewards: dice=0.011, rec=0.761, prec=0.006, shape=0.895, int=0.241, cont=0.783, bound=0.747
2025-12-24 23:33:11,856 - INFO -   New best IoU: 0.0078
2025-12-24 23:35:09,473 - INFO - Epoch 40/100 | Loss: 8.2338 | IoU: 0.0086 | Dice: 0.0171 | Prec: 0.0087 | Rec: 0.4719 | CC: 17500 | Eps: 0.442 | Time: 117.6s
2025-12-24 23:35:09,475 - INFO -   Rewards: dice=0.010, rec=0.685, prec=0.005, shape=0.851, int=0.214, cont=0.673, bound=0.707
2025-12-24 23:35:09,562 - INFO -   New best IoU: 0.0086
2025-12-24 23:37:09,313 - INFO - Epoch 41/100 | Loss: 3.1671 | IoU: 0.0043 | Dice: 0.0085 | Prec: 0.0043 | Rec: 0.9644 | CC: 815 | Eps: 0.429 | Time: 119.1s
2025-12-24 23:37:09,314 - INFO -   Rewards: dice=0.012, rec=0.695, prec=0.006, shape=0.888, int=0.241, cont=0.745, bound=0.767
2025-12-24 23:39:09,074 - INFO - Epoch 42/100 | Loss: 4.7536 | IoU: 0.0051 | Dice: 0.0101 | Prec: 0.0051 | Rec: 1.0000 | CC: 4944 | Eps: 0.416 | Time: 119.8s
2025-12-24 23:39:09,075 - INFO -   Rewards: dice=0.011, rec=0.826, prec=0.006, shape=0.892, int=0.248, cont=0.837, bound=0.756
2025-12-24 23:41:07,525 - INFO - Epoch 43/100 | Loss: 8.9430 | IoU: 0.0012 | Dice: 0.0023 | Prec: 0.0012 | Rec: 0.3267 | CC: 65458 | Eps: 0.404 | Time: 118.4s
2025-12-24 23:41:07,526 - INFO -   Rewards: dice=0.008, rec=0.763, prec=0.004, shape=0.930, int=0.219, cont=0.888, bound=0.710
2025-12-24 23:43:07,554 - INFO - Epoch 44/100 | Loss: 14.9880 | IoU: 0.0020 | Dice: 0.0040 | Prec: 0.0020 | Rec: 0.5366 | CC: 36244 | Eps: 0.392 | Time: 120.0s
2025-12-24 23:43:07,555 - INFO -   Rewards: dice=0.004, rec=0.599, prec=0.002, shape=0.967, int=0.230, cont=0.873, bound=0.710
2025-12-24 23:45:07,166 - INFO - Epoch 45/100 | Loss: 10.8764 | IoU: 0.0012 | Dice: 0.0025 | Prec: 0.0012 | Rec: 0.2975 | CC: 7684 | Eps: 0.380 | Time: 119.6s
2025-12-24 23:45:07,167 - INFO -   Rewards: dice=0.009, rec=0.562, prec=0.005, shape=0.945, int=0.211, cont=0.833, bound=0.714
2025-12-24 23:47:06,172 - INFO - Epoch 46/100 | Loss: 12.6947 | IoU: 0.0024 | Dice: 0.0047 | Prec: 0.0024 | Rec: 0.7439 | CC: 121627 | Eps: 0.368 | Time: 119.0s
2025-12-24 23:47:06,173 - INFO -   Rewards: dice=0.005, rec=0.495, prec=0.003, shape=0.969, int=0.206, cont=0.893, bound=0.714
2025-12-24 23:49:06,987 - INFO - Epoch 47/100 | Loss: 11.1327 | IoU: 0.0024 | Dice: 0.0049 | Prec: 0.0025 | Rec: 0.6665 | CC: 343602 | Eps: 0.357 | Time: 120.8s
2025-12-24 23:49:06,989 - INFO -   Rewards: dice=0.005, rec=0.679, prec=0.003, shape=0.972, int=0.229, cont=0.926, bound=0.741
2025-12-24 23:51:14,274 - INFO - Epoch 48/100 | Loss: 11.3833 | IoU: 0.0006 | Dice: 0.0013 | Prec: 0.0006 | Rec: 0.5075 | CC: 371639 | Eps: 0.346 | Time: 127.3s
2025-12-24 23:51:14,275 - INFO -   Rewards: dice=0.008, rec=0.774, prec=0.004, shape=0.965, int=0.249, cont=0.934, bound=0.754
2025-12-24 23:53:21,120 - INFO - Epoch 49/100 | Loss: 10.2594 | IoU: 0.0007 | Dice: 0.0014 | Prec: 0.0007 | Rec: 0.4529 | CC: 44895 | Eps: 0.335 | Time: 126.8s
2025-12-24 23:53:21,121 - INFO -   Rewards: dice=0.008, rec=0.567, prec=0.004, shape=0.962, int=0.257, cont=0.917, bound=0.764
2025-12-24 23:55:21,608 - INFO - Epoch 50/100 | Loss: 19.4103 | IoU: 0.0015 | Dice: 0.0029 | Prec: 0.0015 | Rec: 0.9929 | CC: 127715 | Eps: 0.324 | Time: 120.5s
2025-12-24 23:55:21,609 - INFO -   Rewards: dice=0.006, rec=0.715, prec=0.003, shape=0.972, int=0.245, cont=0.906, bound=0.715
2025-12-24 23:57:23,941 - INFO - Epoch 51/100 | Loss: 18.5099 | IoU: 0.0010 | Dice: 0.0020 | Prec: 0.0010 | Rec: 0.9837 | CC: 105286 | Eps: 0.313 | Time: 121.6s
2025-12-24 23:57:23,943 - INFO -   Rewards: dice=0.009, rec=0.735, prec=0.005, shape=0.917, int=0.264, cont=0.915, bound=0.738
2025-12-24 23:59:21,251 - INFO - Epoch 52/100 | Loss: 11.9085 | IoU: 0.0006 | Dice: 0.0013 | Prec: 0.0006 | Rec: 0.9231 | CC: 9012 | Eps: 0.303 | Time: 117.3s
2025-12-24 23:59:21,253 - INFO -   Rewards: dice=0.007, rec=0.817, prec=0.003, shape=0.780, int=0.251, cont=0.964, bound=0.726
2025-12-25 00:01:19,947 - INFO - Epoch 53/100 | Loss: 11.0268 | IoU: 0.0010 | Dice: 0.0020 | Prec: 0.0010 | Rec: 0.8429 | CC: 11177 | Eps: 0.293 | Time: 118.7s
2025-12-25 00:01:19,949 - INFO -   Rewards: dice=0.006, rec=0.810, prec=0.003, shape=0.672, int=0.260, cont=0.946, bound=0.727
2025-12-25 00:03:20,557 - INFO - Epoch 54/100 | Loss: 11.3647 | IoU: 0.0011 | Dice: 0.0022 | Prec: 0.0011 | Rec: 0.8991 | CC: 16402 | Eps: 0.283 | Time: 120.6s
2025-12-25 00:03:20,558 - INFO -   Rewards: dice=0.006, rec=0.829, prec=0.003, shape=0.832, int=0.249, cont=0.941, bound=0.724
2025-12-25 17:06:01,426 - INFO - Device: cuda
2025-12-25 17:06:01,426 - INFO - Train: vol=['week2-joint-contrast-adjusted.npy'], mask=['week2-joint-root-class.nii.gz']
2025-12-25 17:06:01,426 - INFO - Val: vol=['week3-joint-contrast-adjusted.npy'], mask=['week3-joint-root-class.nii.gz']
2025-12-25 17:06:02,846 - INFO - Train: (800, 466, 471), fg=0.0217%
2025-12-25 17:06:02,886 - INFO - Val: (800, 466, 471), fg=0.0527%
2025-12-25 17:10:58,361 - INFO - Model params: 1,927,618
2025-12-25 17:10:59,094 - INFO - Starting training: Namespace(train_dir='../data/rapids-p/train', val_dir='../data/rapids-p/val', epochs=100, episodes_per_epoch=20, slices_per_episode=64, batch_size=16, lr=0.0003, gamma=0.95, buffer_capacity=50000, start_epsilon=1.0, end_epsilon=0.05, warmup_epochs=5, history_len=3, base_channels=32, target_update_every=200, dice_coef=1.0, recall_coef=0.8, precision_coef=0.5, shape_coef=0.3, intensity_coef=0.2, continuity_coef=0.1, boundary_coef=0.2, max_avg_width=8.0, roi_dilation=15, use_patches=False, patch_size=128, patch_jitter=20, save_dir='dqn_slice_based/models', seed=42)
2025-12-25 17:15:44,583 - INFO - Device: cuda
2025-12-25 17:15:44,583 - INFO - Train: vol=['week2-joint-contrast-adjusted.npy'], mask=['week2-joint-root-class.nii.gz']
2025-12-25 17:15:44,583 - INFO - Val: vol=['week3-joint-contrast-adjusted.npy'], mask=['week3-joint-root-class.nii.gz']
2025-12-25 17:15:45,992 - INFO - Train: (800, 466, 471), fg=0.0217%
2025-12-25 17:15:46,030 - INFO - Val: (800, 466, 471), fg=0.0527%
2025-12-25 17:20:41,671 - INFO - Model params: 1,927,618
2025-12-25 17:20:42,401 - INFO - Starting training: Namespace(train_dir='../data/rapids-p/train', val_dir='../data/rapids-p/val', epochs=50, episodes_per_epoch=20, slices_per_episode=64, batch_size=16, lr=0.0003, gamma=0.95, buffer_capacity=50000, start_epsilon=1.0, end_epsilon=0.05, warmup_epochs=5, history_len=3, base_channels=32, target_update_every=200, dice_coef=1.0, recall_coef=0.8, precision_coef=0.5, shape_coef=0.3, intensity_coef=0.2, continuity_coef=0.1, boundary_coef=0.2, max_avg_width=8.0, roi_dilation=15, use_patches=True, patch_size=128, patch_jitter=20, save_dir='dqn_slice_based/models', seed=42)
2025-12-25 17:22:50,960 - INFO - Epoch 1/50 | Loss: 0.3192 | IoU: 0.0004 | Dice: 0.0007 | Prec: 0.0004 | Rec: 0.6018 | CC: 2343 | Eps: 1.000 | Time: 128.6s
2025-12-25 17:22:50,961 - INFO -   Rewards: dice=0.003, rec=0.546, prec=0.002, shape=0.950, int=0.203, cont=0.992, bound=0.967
2025-12-25 17:22:51,008 - INFO -   New best IoU: 0.0004
2025-12-25 17:24:59,110 - INFO - Epoch 2/50 | Loss: 0.8839 | IoU: 0.0008 | Dice: 0.0017 | Prec: 0.0008 | Rec: 0.8334 | CC: 117896 | Eps: 1.000 | Time: 127.4s
2025-12-25 17:24:59,111 - INFO -   Rewards: dice=0.003, rec=0.555, prec=0.001, shape=0.950, int=0.193, cont=0.992, bound=0.966
2025-12-25 17:24:59,225 - INFO -   New best IoU: 0.0008
2025-12-25 17:27:08,485 - INFO - Epoch 3/50 | Loss: 2.7429 | IoU: 0.0007 | Dice: 0.0014 | Prec: 0.0007 | Rec: 0.9686 | CC: 179288 | Eps: 1.000 | Time: 129.3s
2025-12-25 17:27:08,486 - INFO -   Rewards: dice=0.003, rec=0.544, prec=0.002, shape=0.950, int=0.225, cont=0.992, bound=0.999
2025-12-25 17:29:14,095 - INFO - Epoch 4/50 | Loss: 1.2922 | IoU: 0.0045 | Dice: 0.0090 | Prec: 0.0045 | Rec: 0.7974 | CC: 181990 | Eps: 1.000 | Time: 125.6s
2025-12-25 17:29:14,096 - INFO -   Rewards: dice=0.003, rec=0.556, prec=0.001, shape=0.950, int=0.209, cont=0.992, bound=0.999
2025-12-25 17:29:14,182 - INFO -   New best IoU: 0.0045
2025-12-25 17:31:19,587 - INFO - Epoch 5/50 | Loss: 2.3650 | IoU: 0.0006 | Dice: 0.0012 | Prec: 0.0006 | Rec: 0.6321 | CC: 300853 | Eps: 1.000 | Time: 125.4s
2025-12-25 17:31:19,588 - INFO -   Rewards: dice=0.004, rec=0.568, prec=0.002, shape=0.950, int=0.254, cont=0.992, bound=0.998
2025-12-25 17:33:25,640 - INFO - Epoch 6/50 | Loss: 1.3769 | IoU: 0.0005 | Dice: 0.0011 | Prec: 0.0005 | Rec: 0.3095 | CC: 590702 | Eps: 1.000 | Time: 126.1s
2025-12-25 17:33:25,641 - INFO -   Rewards: dice=0.005, rec=0.530, prec=0.003, shape=0.950, int=0.245, cont=0.992, bound=0.999
2025-12-25 17:35:30,007 - INFO - Epoch 7/50 | Loss: 2.1066 | IoU: 0.0005 | Dice: 0.0010 | Prec: 0.0005 | Rec: 0.4069 | CC: 393154 | Eps: 0.958 | Time: 124.4s
2025-12-25 17:35:30,008 - INFO -   Rewards: dice=0.007, rec=0.554, prec=0.003, shape=0.927, int=0.265, cont=0.977, bound=1.000
2025-12-25 17:37:31,753 - INFO - Epoch 8/50 | Loss: 1.9527 | IoU: 0.0005 | Dice: 0.0010 | Prec: 0.0005 | Rec: 0.2603 | CC: 153711 | Eps: 0.917 | Time: 121.7s
2025-12-25 17:37:31,754 - INFO -   Rewards: dice=0.004, rec=0.558, prec=0.002, shape=0.913, int=0.218, cont=0.966, bound=0.991
2025-12-25 17:39:35,082 - INFO - Epoch 9/50 | Loss: 2.4466 | IoU: 0.0003 | Dice: 0.0007 | Prec: 0.0003 | Rec: 0.1548 | CC: 72524 | Eps: 0.878 | Time: 123.3s
2025-12-25 17:39:35,083 - INFO -   Rewards: dice=0.005, rec=0.581, prec=0.002, shape=0.899, int=0.246, cont=0.956, bound=0.999
2025-12-25 17:41:36,616 - INFO - Epoch 10/50 | Loss: 2.4283 | IoU: 0.0006 | Dice: 0.0012 | Prec: 0.0006 | Rec: 0.2598 | CC: 63587 | Eps: 0.839 | Time: 121.5s
2025-12-25 17:41:36,617 - INFO -   Rewards: dice=0.004, rec=0.595, prec=0.002, shape=0.857, int=0.216, cont=0.932, bound=0.998
2025-12-25 17:43:38,696 - INFO - Epoch 11/50 | Loss: 11.7255 | IoU: 0.0091 | Dice: 0.0180 | Prec: 0.0091 | Rec: 0.7945 | CC: 144930 | Eps: 0.801 | Time: 121.5s
2025-12-25 17:43:38,697 - INFO -   Rewards: dice=0.005, rec=0.618, prec=0.003, shape=0.928, int=0.204, cont=0.919, bound=1.000
2025-12-25 17:43:38,751 - INFO -   New best IoU: 0.0091
2025-12-25 17:45:38,006 - INFO - Epoch 12/50 | Loss: 2.0462 | IoU: 0.0000 | Dice: 0.0000 | Prec: 0.0000 | Rec: 0.0016 | CC: 41910 | Eps: 0.764 | Time: 119.3s
2025-12-25 17:45:38,008 - INFO -   Rewards: dice=0.007, rec=0.594, prec=0.004, shape=0.918, int=0.226, cont=0.848, bound=0.967
2025-12-25 17:47:37,855 - INFO - Epoch 13/50 | Loss: 4.9765 | IoU: 0.0003 | Dice: 0.0006 | Prec: 0.0003 | Rec: 0.1054 | CC: 224212 | Eps: 0.727 | Time: 119.8s
2025-12-25 17:47:37,857 - INFO -   Rewards: dice=0.007, rec=0.535, prec=0.004, shape=0.912, int=0.238, cont=0.844, bound=0.998
2025-12-25 17:49:36,113 - INFO - Epoch 14/50 | Loss: 70.2883 | IoU: 0.0000 | Dice: 0.0000 | Prec: 0.0000 | Rec: 0.0000 | CC: 7 | Eps: 0.692 | Time: 118.3s
2025-12-25 17:49:36,115 - INFO -   Rewards: dice=0.009, rec=0.379, prec=0.179, shape=0.838, int=0.273, cont=0.680, bound=0.890
2025-12-25 17:51:34,875 - INFO - Epoch 15/50 | Loss: 87.7033 | IoU: 0.0002 | Dice: 0.0003 | Prec: 0.0002 | Rec: 0.1722 | CC: 44016 | Eps: 0.658 | Time: 118.8s
2025-12-25 17:51:34,876 - INFO -   Rewards: dice=0.016, rec=0.457, prec=0.090, shape=0.898, int=0.286, cont=0.756, bound=0.950
2025-12-25 17:53:36,766 - INFO - Epoch 16/50 | Loss: 2.5570 | IoU: 0.0007 | Dice: 0.0013 | Prec: 0.0007 | Rec: 0.2774 | CC: 389257 | Eps: 0.625 | Time: 121.9s
2025-12-25 17:53:36,768 - INFO -   Rewards: dice=0.007, rec=0.596, prec=0.003, shape=0.849, int=0.248, cont=0.953, bound=1.000
2025-12-25 17:55:37,066 - INFO - Epoch 17/50 | Loss: 38.3672 | IoU: 0.0000 | Dice: 0.0000 | Prec: 0.0000 | Rec: 0.0000 | CC: 995836 | Eps: 0.592 | Time: 120.3s
2025-12-25 17:55:37,067 - INFO -   Rewards: dice=0.005, rec=0.542, prec=0.003, shape=0.877, int=0.232, cont=0.885, bound=0.989
2025-12-25 17:57:41,240 - INFO - Epoch 18/50 | Loss: 948.1368 | IoU: 0.0026 | Dice: 0.0052 | Prec: 0.0026 | Rec: 0.9252 | CC: 1179362 | Eps: 0.561 | Time: 124.2s
2025-12-25 17:57:41,242 - INFO -   Rewards: dice=0.010, rec=0.482, prec=0.005, shape=0.937, int=0.261, cont=0.803, bound=1.000
2025-12-25 17:59:41,419 - INFO - Epoch 19/50 | Loss: 1616.0545 | IoU: 0.0023 | Dice: 0.0045 | Prec: 0.0023 | Rec: 0.9705 | CC: 794586 | Eps: 0.530 | Time: 120.2s
2025-12-25 17:59:41,420 - INFO -   Rewards: dice=0.008, rec=0.757, prec=0.004, shape=0.928, int=0.249, cont=0.870, bound=1.000
2025-12-25 18:01:39,516 - INFO - Epoch 20/50 | Loss: 1769.3974 | IoU: 0.0014 | Dice: 0.0029 | Prec: 0.0014 | Rec: 0.9877 | CC: 257803 | Eps: 0.501 | Time: 118.1s
2025-12-25 18:01:39,517 - INFO -   Rewards: dice=0.007, rec=0.787, prec=0.004, shape=0.905, int=0.244, cont=0.810, bound=0.998
2025-12-25 18:03:37,662 - INFO - Epoch 21/50 | Loss: 1157.4661 | IoU: 0.0027 | Dice: 0.0054 | Prec: 0.0027 | Rec: 0.9740 | CC: 12696 | Eps: 0.472 | Time: 117.6s
2025-12-25 18:03:37,663 - INFO -   Rewards: dice=0.009, rec=0.807, prec=0.004, shape=0.886, int=0.245, cont=0.775, bound=1.000
2025-12-25 18:05:35,888 - INFO - Epoch 22/50 | Loss: 0.7427 | IoU: 0.0023 | Dice: 0.0047 | Prec: 0.0023 | Rec: 0.9732 | CC: 16266 | Eps: 0.445 | Time: 118.2s
2025-12-25 18:05:35,889 - INFO -   Rewards: dice=0.009, rec=0.787, prec=0.004, shape=0.873, int=0.219, cont=0.772, bound=1.000
2025-12-25 18:07:31,796 - INFO - Epoch 23/50 | Loss: 1.7010 | IoU: 0.0062 | Dice: 0.0122 | Prec: 0.0062 | Rec: 0.9305 | CC: 29689 | Eps: 0.418 | Time: 115.9s
2025-12-25 18:07:31,798 - INFO -   Rewards: dice=0.011, rec=0.792, prec=0.006, shape=0.849, int=0.262, cont=0.763, bound=0.992
2025-12-25 18:09:33,057 - INFO - Epoch 24/50 | Loss: 2.8511 | IoU: 0.0060 | Dice: 0.0119 | Prec: 0.0060 | Rec: 0.9641 | CC: 97589 | Eps: 0.392 | Time: 121.3s
2025-12-25 18:09:33,058 - INFO -   Rewards: dice=0.013, rec=0.804, prec=0.007, shape=0.902, int=0.250, cont=0.755, bound=0.998
2025-12-25 18:11:31,720 - INFO - Epoch 25/50 | Loss: 2.8837 | IoU: 0.0030 | Dice: 0.0059 | Prec: 0.0030 | Rec: 0.9862 | CC: 10841 | Eps: 0.367 | Time: 118.7s
2025-12-25 18:11:31,721 - INFO -   Rewards: dice=0.012, rec=0.815, prec=0.006, shape=0.899, int=0.236, cont=0.754, bound=1.000
2025-12-25 18:13:24,166 - INFO - Epoch 26/50 | Loss: 3.8280 | IoU: 0.0034 | Dice: 0.0068 | Prec: 0.0034 | Rec: 0.9862 | CC: 20637 | Eps: 0.343 | Time: 112.4s
2025-12-25 18:13:24,168 - INFO -   Rewards: dice=0.009, rec=0.853, prec=0.005, shape=0.906, int=0.232, cont=0.779, bound=0.991
2025-12-25 18:15:20,183 - INFO - Epoch 27/50 | Loss: 1.9162 | IoU: 0.0032 | Dice: 0.0063 | Prec: 0.0032 | Rec: 0.9852 | CC: 8446 | Eps: 0.320 | Time: 116.0s
2025-12-25 18:15:20,184 - INFO -   Rewards: dice=0.013, rec=0.832, prec=0.007, shape=0.861, int=0.249, cont=0.769, bound=0.996
2025-12-25 18:17:16,202 - INFO - Epoch 28/50 | Loss: 3.1082 | IoU: 0.0025 | Dice: 0.0050 | Prec: 0.0025 | Rec: 0.9862 | CC: 705 | Eps: 0.298 | Time: 116.0s
2025-12-25 18:17:16,203 - INFO -   Rewards: dice=0.010, rec=0.869, prec=0.005, shape=0.866, int=0.260, cont=0.744, bound=0.999
2025-12-25 18:19:07,242 - INFO - Epoch 29/50 | Loss: 5.8072 | IoU: 0.0058 | Dice: 0.0116 | Prec: 0.0058 | Rec: 0.9059 | CC: 29331 | Eps: 0.277 | Time: 111.0s
2025-12-25 18:19:07,243 - INFO -   Rewards: dice=0.015, rec=0.874, prec=0.008, shape=0.781, int=0.248, cont=0.668, bound=0.999
2025-12-25 18:21:04,087 - INFO - Epoch 30/50 | Loss: 7.0436 | IoU: 0.0017 | Dice: 0.0033 | Prec: 0.0017 | Rec: 0.8939 | CC: 35965 | Eps: 0.257 | Time: 116.8s
2025-12-25 18:21:04,088 - INFO -   Rewards: dice=0.011, rec=0.850, prec=0.006, shape=0.920, int=0.237, cont=0.789, bound=1.000
2025-12-25 18:23:00,280 - INFO - Epoch 31/50 | Loss: 7.3241 | IoU: 0.0017 | Dice: 0.0033 | Prec: 0.0017 | Rec: 0.9086 | CC: 35635 | Eps: 0.238 | Time: 115.6s
2025-12-25 18:23:00,282 - INFO -   Rewards: dice=0.008, rec=0.887, prec=0.004, shape=0.935, int=0.262, cont=0.845, bound=0.983
2025-12-25 18:24:51,095 - INFO - Epoch 32/50 | Loss: 5.1416 | IoU: 0.0021 | Dice: 0.0043 | Prec: 0.0021 | Rec: 0.9767 | CC: 1658 | Eps: 0.219 | Time: 110.8s
2025-12-25 18:24:51,097 - INFO -   Rewards: dice=0.009, rec=0.887, prec=0.005, shape=0.923, int=0.253, cont=0.844, bound=0.999
2025-12-25 18:26:41,312 - INFO - Epoch 33/50 | Loss: 3.9356 | IoU: 0.0019 | Dice: 0.0038 | Prec: 0.0019 | Rec: 0.9707 | CC: 2656 | Eps: 0.202 | Time: 110.2s
2025-12-25 18:26:41,313 - INFO -   Rewards: dice=0.012, rec=0.911, prec=0.006, shape=0.877, int=0.243, cont=0.874, bound=0.995
2025-12-25 18:28:33,834 - INFO - Epoch 34/50 | Loss: 4.3288 | IoU: 0.0011 | Dice: 0.0023 | Prec: 0.0011 | Rec: 0.9237 | CC: 68765 | Eps: 0.186 | Time: 112.5s
2025-12-25 18:28:33,835 - INFO -   Rewards: dice=0.012, rec=0.893, prec=0.006, shape=0.896, int=0.231, cont=0.827, bound=0.991
2025-12-25 18:30:23,863 - INFO - Epoch 35/50 | Loss: 5.4550 | IoU: 0.0017 | Dice: 0.0035 | Prec: 0.0017 | Rec: 0.9445 | CC: 16948 | Eps: 0.170 | Time: 110.0s
2025-12-25 18:30:23,864 - INFO -   Rewards: dice=0.012, rec=0.908, prec=0.006, shape=0.885, int=0.243, cont=0.809, bound=1.000
2025-12-25 18:32:13,657 - INFO - Epoch 36/50 | Loss: 5.7710 | IoU: 0.0018 | Dice: 0.0037 | Prec: 0.0018 | Rec: 0.9322 | CC: 52102 | Eps: 0.156 | Time: 109.8s
2025-12-25 18:32:13,658 - INFO -   Rewards: dice=0.008, rec=0.914, prec=0.004, shape=0.908, int=0.216, cont=0.854, bound=0.983
2025-12-25 18:34:04,054 - INFO - Epoch 37/50 | Loss: 6.4056 | IoU: 0.0018 | Dice: 0.0036 | Prec: 0.0018 | Rec: 0.9662 | CC: 86334 | Eps: 0.142 | Time: 110.4s
2025-12-25 18:34:04,055 - INFO -   Rewards: dice=0.009, rec=0.911, prec=0.005, shape=0.921, int=0.215, cont=0.802, bound=0.991
2025-12-25 18:35:53,033 - INFO - Epoch 38/50 | Loss: 5.4707 | IoU: 0.0019 | Dice: 0.0037 | Prec: 0.0019 | Rec: 0.9746 | CC: 75649 | Eps: 0.129 | Time: 109.0s
2025-12-25 18:35:53,035 - INFO -   Rewards: dice=0.010, rec=0.937, prec=0.005, shape=0.908, int=0.233, cont=0.804, bound=0.999
2025-12-25 18:37:42,598 - INFO - Epoch 39/50 | Loss: 5.1977 | IoU: 0.0018 | Dice: 0.0036 | Prec: 0.0018 | Rec: 0.9263 | CC: 69750 | Eps: 0.118 | Time: 109.6s
2025-12-25 18:37:42,599 - INFO -   Rewards: dice=0.010, rec=0.912, prec=0.005, shape=0.920, int=0.239, cont=0.803, bound=0.998
2025-12-25 18:39:31,157 - INFO - Epoch 40/50 | Loss: 8.1041 | IoU: 0.0011 | Dice: 0.0023 | Prec: 0.0011 | Rec: 0.9846 | CC: 57034 | Eps: 0.107 | Time: 108.6s
2025-12-25 18:39:31,159 - INFO -   Rewards: dice=0.006, rec=0.931, prec=0.003, shape=0.916, int=0.213, cont=0.778, bound=0.984
2025-12-25 18:41:19,327 - INFO - Epoch 41/50 | Loss: 2.2034 | IoU: 0.0012 | Dice: 0.0024 | Prec: 0.0012 | Rec: 0.9864 | CC: 116339 | Eps: 0.097 | Time: 107.6s
2025-12-25 18:41:19,328 - INFO -   Rewards: dice=0.008, rec=0.955, prec=0.004, shape=0.903, int=0.239, cont=0.813, bound=0.998
2025-12-25 18:43:06,110 - INFO - Epoch 42/50 | Loss: 2.5902 | IoU: 0.0018 | Dice: 0.0037 | Prec: 0.0018 | Rec: 0.9351 | CC: 110079 | Eps: 0.088 | Time: 106.8s
2025-12-25 18:43:06,112 - INFO -   Rewards: dice=0.011, rec=0.950, prec=0.006, shape=0.921, int=0.247, cont=0.820, bound=0.999
2025-12-25 18:44:54,333 - INFO - Epoch 43/50 | Loss: 3.5108 | IoU: 0.0017 | Dice: 0.0033 | Prec: 0.0017 | Rec: 0.9199 | CC: 169812 | Eps: 0.080 | Time: 108.2s
2025-12-25 18:44:54,335 - INFO -   Rewards: dice=0.011, rec=0.957, prec=0.006, shape=0.919, int=0.219, cont=0.798, bound=0.976
2025-12-25 18:46:41,999 - INFO - Epoch 44/50 | Loss: 3.9449 | IoU: 0.0018 | Dice: 0.0035 | Prec: 0.0018 | Rec: 0.9132 | CC: 160869 | Eps: 0.073 | Time: 107.7s
2025-12-25 18:46:42,001 - INFO -   Rewards: dice=0.008, rec=0.950, prec=0.004, shape=0.935, int=0.226, cont=0.797, bound=0.984
2025-12-25 18:48:29,133 - INFO - Epoch 45/50 | Loss: 5.2255 | IoU: 0.0019 | Dice: 0.0039 | Prec: 0.0019 | Rec: 0.9408 | CC: 83749 | Eps: 0.067 | Time: 107.1s
2025-12-25 18:48:29,134 - INFO -   Rewards: dice=0.012, rec=0.955, prec=0.006, shape=0.914, int=0.208, cont=0.811, bound=0.984
2025-12-25 18:50:16,981 - INFO - Epoch 46/50 | Loss: 5.3128 | IoU: 0.0018 | Dice: 0.0036 | Prec: 0.0018 | Rec: 0.9409 | CC: 168220 | Eps: 0.062 | Time: 107.8s
2025-12-25 18:50:16,982 - INFO -   Rewards: dice=0.011, rec=0.956, prec=0.005, shape=0.916, int=0.205, cont=0.817, bound=1.000
2025-12-25 18:52:03,473 - INFO - Epoch 47/50 | Loss: 5.8507 | IoU: 0.0017 | Dice: 0.0033 | Prec: 0.0017 | Rec: 0.9357 | CC: 155252 | Eps: 0.058 | Time: 106.5s
2025-12-25 18:52:03,474 - INFO -   Rewards: dice=0.009, rec=0.968, prec=0.005, shape=0.941, int=0.227, cont=0.845, bound=0.999
2025-12-25 18:53:50,128 - INFO - Epoch 48/50 | Loss: 6.6865 | IoU: 0.0016 | Dice: 0.0033 | Prec: 0.0016 | Rec: 0.9474 | CC: 111129 | Eps: 0.054 | Time: 106.7s
2025-12-25 18:53:50,129 - INFO -   Rewards: dice=0.011, rec=0.973, prec=0.005, shape=0.966, int=0.248, cont=0.849, bound=1.000
2025-12-25 18:55:38,921 - INFO - Epoch 49/50 | Loss: 9.7010 | IoU: 0.0020 | Dice: 0.0040 | Prec: 0.0020 | Rec: 0.9844 | CC: 86049 | Eps: 0.052 | Time: 108.8s
2025-12-25 18:55:38,923 - INFO -   Rewards: dice=0.012, rec=0.962, prec=0.006, shape=0.963, int=0.257, cont=0.849, bound=0.999
2025-12-25 18:57:24,861 - INFO - Epoch 50/50 | Loss: 13.7303 | IoU: 0.0031 | Dice: 0.0062 | Prec: 0.0031 | Rec: 0.9863 | CC: 124430 | Eps: 0.050 | Time: 105.9s
2025-12-25 18:57:24,863 - INFO -   Rewards: dice=0.007, rec=0.978, prec=0.004, shape=0.983, int=0.243, cont=0.875, bound=1.000
2025-12-25 18:57:25,625 - INFO - Training complete. Best IoU: 0.0091
2025-12-25 18:57:45,548 - INFO - Device: cuda
2025-12-25 18:57:45,549 - INFO - Train: vol=['week2-joint-contrast-adjusted.npy'], mask=['week2-joint-root-class.nii.gz']
2025-12-25 18:57:45,549 - INFO - Val: vol=['week3-joint-contrast-adjusted.npy'], mask=['week3-joint-root-class.nii.gz']
2025-12-25 18:57:46,930 - INFO - Train: (800, 466, 471), fg=0.0217%
2025-12-25 18:57:46,964 - INFO - Val: (800, 466, 471), fg=0.0527%
2025-12-25 19:02:42,216 - INFO - Model params: 1,927,618
2025-12-25 19:02:42,958 - INFO - Starting training: Namespace(train_dir='../data/rapids-p/train', val_dir='../data/rapids-p/val', epochs=100, episodes_per_epoch=20, slices_per_episode=64, batch_size=16, lr=0.0003, gamma=0.95, buffer_capacity=50000, start_epsilon=1.0, end_epsilon=0.05, warmup_epochs=5, history_len=3, base_channels=32, target_update_every=200, dice_coef=1.0, recall_coef=0.8, precision_coef=0.5, shape_coef=0.3, intensity_coef=0.2, continuity_coef=0.1, boundary_coef=0.2, max_avg_width=8.0, roi_dilation=15, use_patches=True, patch_size=128, patch_jitter=20, save_dir='dqn_slice_based/models', seed=42)
2025-12-26 16:51:32,132 - INFO - Device: cuda
2025-12-26 16:51:32,137 - INFO - Loading training subvolumes from ../data/rapids-p/subvolumes_100x64x64/train
2025-12-26 16:51:32,140 - INFO - Loaded: week2_d00_h00_w04_vol.npy ((100, 64, 64), fg=0.0417%)
2025-12-26 16:51:32,143 - INFO - Loaded: week2_d01_h00_w04_vol.npy ((100, 64, 64), fg=0.1055%)
2025-12-26 16:51:32,145 - INFO - Loaded: week2_d02_h00_w04_vol.npy ((100, 64, 64), fg=0.0107%)
2025-12-26 16:51:32,147 - INFO - Loaded: week2_d02_h01_w04_vol.npy ((100, 64, 64), fg=0.2913%)
2025-12-26 16:51:32,149 - INFO - Loaded: week2_d02_h04_w00_vol.npy ((100, 64, 64), fg=0.1423%)
2025-12-26 16:51:32,151 - INFO - Loaded: week2_d02_h04_w06_vol.npy ((100, 64, 64), fg=0.0176%)
2025-12-26 16:51:32,153 - INFO - Loaded: week2_d03_h01_w04_vol.npy ((100, 64, 64), fg=0.0117%)
2025-12-26 16:51:32,155 - INFO - Loaded: week2_d03_h02_w02_vol.npy ((100, 64, 64), fg=0.0210%)
2025-12-26 16:51:32,157 - INFO - Loaded: week2_d03_h02_w04_vol.npy ((100, 64, 64), fg=0.2253%)
2025-12-26 16:51:32,159 - INFO - Loaded: week2_d03_h03_w01_vol.npy ((100, 64, 64), fg=0.0710%)
2025-12-26 16:51:32,161 - INFO - Loaded: week2_d03_h03_w02_vol.npy ((100, 64, 64), fg=0.1863%)
2025-12-26 16:51:32,163 - INFO - Loaded: week2_d03_h03_w03_vol.npy ((100, 64, 64), fg=0.6755%)
2025-12-26 16:51:32,165 - INFO - Loaded: week2_d03_h03_w04_vol.npy ((100, 64, 64), fg=0.3538%)
2025-12-26 16:51:32,167 - INFO - Loaded: week2_d03_h04_w01_vol.npy ((100, 64, 64), fg=0.0154%)
2025-12-26 16:51:32,169 - INFO - Loaded: week2_d03_h04_w02_vol.npy ((100, 64, 64), fg=0.0142%)
2025-12-26 16:51:32,171 - INFO - Loaded: week2_d03_h04_w03_vol.npy ((100, 64, 64), fg=0.0896%)
2025-12-26 16:51:32,173 - INFO - Loaded: week2_d03_h04_w04_vol.npy ((100, 64, 64), fg=0.0903%)
2025-12-26 16:51:32,175 - INFO - Loaded: week2_d03_h04_w05_vol.npy ((100, 64, 64), fg=0.0771%)
2025-12-26 16:51:32,177 - INFO - Loaded: week2_d03_h04_w06_vol.npy ((100, 64, 64), fg=0.2573%)
2025-12-26 16:51:32,179 - INFO - Loaded: week2_d03_h05_w04_vol.npy ((100, 64, 64), fg=0.1111%)
2025-12-26 16:51:32,181 - INFO - Loaded: week2_d03_h05_w05_vol.npy ((100, 64, 64), fg=0.1348%)
2025-12-26 16:51:32,183 - INFO - Loaded: week2_d03_h05_w06_vol.npy ((100, 64, 64), fg=0.0396%)
2025-12-26 16:51:32,185 - INFO - Loaded: week2_d04_h03_w03_vol.npy ((100, 64, 64), fg=0.5879%)
2025-12-26 16:51:32,187 - INFO - Loaded: week2_d04_h03_w04_vol.npy ((100, 64, 64), fg=0.1567%)
2025-12-26 16:51:32,189 - INFO - Loaded: week2_d04_h04_w03_vol.npy ((100, 64, 64), fg=0.1470%)
2025-12-26 16:51:32,191 - INFO - Loaded: week2_d04_h05_w01_vol.npy ((100, 64, 64), fg=0.0933%)
2025-12-26 16:51:32,193 - INFO - Loaded: week2_d04_h05_w02_vol.npy ((100, 64, 64), fg=0.1001%)
2025-12-26 16:51:32,195 - INFO - Loaded: week2_d04_h05_w03_vol.npy ((100, 64, 64), fg=0.1409%)
2025-12-26 16:51:32,197 - INFO - Loaded: week2_d04_h05_w04_vol.npy ((100, 64, 64), fg=0.0320%)
2025-12-26 16:51:32,199 - INFO - Loaded: week2_d04_h06_w05_vol.npy ((100, 64, 64), fg=0.2107%)
2025-12-26 16:51:32,201 - INFO - Loaded: week2_d05_h02_w03_vol.npy ((100, 64, 64), fg=0.0940%)
2025-12-26 16:51:32,203 - INFO - Loaded: week2_d05_h03_w03_vol.npy ((100, 64, 64), fg=0.4832%)
2025-12-26 16:51:32,205 - INFO - Loaded: week2_d05_h03_w04_vol.npy ((100, 64, 64), fg=0.1453%)
2025-12-26 16:51:32,207 - INFO - Loaded: week2_d05_h04_w00_vol.npy ((100, 64, 64), fg=0.0688%)
2025-12-26 16:51:32,209 - INFO - Loaded: week2_d05_h04_w01_vol.npy ((100, 64, 64), fg=0.0457%)
2025-12-26 16:51:32,211 - INFO - Loaded: week2_d05_h04_w03_vol.npy ((100, 64, 64), fg=0.0171%)
2025-12-26 16:51:32,213 - INFO - Loaded: week2_d05_h05_w00_vol.npy ((100, 64, 64), fg=0.0415%)
2025-12-26 16:51:32,214 - INFO - Loaded: week2_d05_h05_w05_vol.npy ((100, 64, 64), fg=0.0686%)
2025-12-26 16:51:32,216 - INFO - Loaded: week2_d05_h05_w06_vol.npy ((100, 64, 64), fg=0.1067%)
2025-12-26 16:51:32,218 - INFO - Loaded: week2_d05_h06_w05_vol.npy ((100, 64, 64), fg=0.0308%)
2025-12-26 16:51:32,220 - INFO - Loaded: week2_d06_h02_w03_vol.npy ((100, 64, 64), fg=0.0854%)
2025-12-26 16:51:32,222 - INFO - Loaded: week2_d06_h03_w02_vol.npy ((100, 64, 64), fg=0.1641%)
2025-12-26 16:51:32,224 - INFO - Loaded: week2_d06_h03_w03_vol.npy ((100, 64, 64), fg=0.3281%)
2025-12-26 16:51:32,226 - INFO - Loaded: week2_d06_h03_w04_vol.npy ((100, 64, 64), fg=0.3699%)
2025-12-26 16:51:32,228 - INFO - Loaded: week2_d06_h04_w01_vol.npy ((100, 64, 64), fg=0.0771%)
2025-12-26 16:51:32,230 - INFO - Loaded: week2_d06_h04_w02_vol.npy ((100, 64, 64), fg=0.0266%)
2025-12-26 16:51:32,232 - INFO - Loaded: week2_d06_h04_w04_vol.npy ((100, 64, 64), fg=0.0652%)
2025-12-26 16:51:32,234 - INFO - Loaded: week2_d06_h04_w05_vol.npy ((100, 64, 64), fg=0.1646%)
2025-12-26 16:51:32,236 - INFO - Loaded: week2_d06_h04_w06_vol.npy ((100, 64, 64), fg=0.0239%)
2025-12-26 16:51:32,238 - INFO - Loaded: week2_d07_h01_w04_vol.npy ((100, 64, 64), fg=0.0833%)
2025-12-26 16:51:32,240 - INFO - Loaded: week2_d07_h02_w04_vol.npy ((100, 64, 64), fg=0.1670%)
2025-12-26 16:51:32,242 - INFO - Loaded: week2_d07_h03_w04_vol.npy ((100, 64, 64), fg=0.2366%)
2025-12-26 16:51:32,244 - INFO - Loaded: week2_d07_h04_w03_vol.npy ((100, 64, 64), fg=0.6177%)
2025-12-26 16:51:32,244 - INFO - Loaded 53 training subvolumes
2025-12-26 16:51:32,244 - INFO - Loading validation subvolumes from ../data/rapids-p/subvolumes_100x64x64/val
2025-12-26 16:51:32,246 - INFO - Loaded: week2_d06_h05_w06_vol.npy ((100, 64, 64), fg=0.0981%)
2025-12-26 16:51:32,248 - INFO - Loaded: week2_d07_h03_w03_vol.npy ((100, 64, 64), fg=1.2075%)
2025-12-26 16:51:32,248 - INFO - Loaded 2 validation subvolumes
2025-12-26 16:51:32,248 - INFO - Subvolume shape: (100, 64, 64)
2025-12-26 16:51:32,491 - INFO - Model params: 1,927,618
2025-12-26 16:51:33,220 - INFO - Starting training: Namespace(train_dir='../data/rapids-p/subvolumes_100x64x64/train', val_dir='../data/rapids-p/subvolumes_100x64x64/val', epochs=5, slices_per_episode=100, batch_size=32, lr=0.0003, gamma=0.95, buffer_capacity=30000, start_epsilon=1.0, end_epsilon=0.05, warmup_epochs=3, history_len=3, base_channels=32, target_update_every=200, dice_coef=1.0, recall_coef=0.8, precision_coef=0.5, shape_coef=0.3, intensity_coef=0.2, continuity_coef=0.1, boundary_coef=0.2, max_avg_width=6.0, roi_dilation=10, save_dir='dqn_slice_based/models', seed=42)
2025-12-26 16:53:29,776 - INFO - Epoch 1/5 | Loss: 1.0017 | IoU: 0.0001 | Dice: 0.0001 | Prec: 0.0001 | Rec: 0.0024 | CC: 293.5 | Eps: 1.000 | Time: 116.6s
2025-12-26 16:53:29,779 - INFO -   Rewards: dice=0.003, rec=0.773, prec=0.001, shape=0.945, int=0.186, cont=0.995, bound=0.988
2025-12-26 16:53:29,920 - INFO -   New best IoU: 0.0001
2025-12-26 16:55:28,257 - INFO - Epoch 2/5 | Loss: 3.0800 | IoU: 0.0001 | Dice: 0.0002 | Prec: 0.0001 | Rec: 0.0116 | CC: 323.5 | Eps: 1.000 | Time: 117.3s
2025-12-26 16:55:28,259 - INFO -   Rewards: dice=0.003, rec=0.775, prec=0.002, shape=0.945, int=0.186, cont=0.995, bound=0.988
2025-12-26 16:55:28,370 - INFO -   New best IoU: 0.0001
2025-12-26 16:56:13,919 - INFO - Device: cuda
2025-12-26 16:56:13,919 - INFO - Loading training subvolumes from ../data/rapids-p/subvolumes_100x64x64/train
2025-12-26 16:56:13,923 - INFO - Loaded: week2_d00_h00_w04_vol.npy ((100, 64, 64), fg=0.0417%)
2025-12-26 16:56:13,925 - INFO - Loaded: week2_d01_h00_w04_vol.npy ((100, 64, 64), fg=0.1055%)
2025-12-26 16:56:13,927 - INFO - Loaded: week2_d02_h00_w04_vol.npy ((100, 64, 64), fg=0.0107%)
2025-12-26 16:56:13,929 - INFO - Loaded: week2_d02_h01_w04_vol.npy ((100, 64, 64), fg=0.2913%)
2025-12-26 16:56:13,931 - INFO - Loaded: week2_d02_h04_w00_vol.npy ((100, 64, 64), fg=0.1423%)
2025-12-26 16:56:13,933 - INFO - Loaded: week2_d02_h04_w06_vol.npy ((100, 64, 64), fg=0.0176%)
2025-12-26 16:56:13,935 - INFO - Loaded: week2_d03_h01_w04_vol.npy ((100, 64, 64), fg=0.0117%)
2025-12-26 16:56:13,937 - INFO - Loaded: week2_d03_h02_w02_vol.npy ((100, 64, 64), fg=0.0210%)
2025-12-26 16:56:13,939 - INFO - Loaded: week2_d03_h02_w04_vol.npy ((100, 64, 64), fg=0.2253%)
2025-12-26 16:56:13,941 - INFO - Loaded: week2_d03_h03_w01_vol.npy ((100, 64, 64), fg=0.0710%)
2025-12-26 16:56:13,943 - INFO - Loaded: week2_d03_h03_w02_vol.npy ((100, 64, 64), fg=0.1863%)
2025-12-26 16:56:13,945 - INFO - Loaded: week2_d03_h03_w03_vol.npy ((100, 64, 64), fg=0.6755%)
2025-12-26 16:56:13,947 - INFO - Loaded: week2_d03_h03_w04_vol.npy ((100, 64, 64), fg=0.3538%)
2025-12-26 16:56:13,949 - INFO - Loaded: week2_d03_h04_w01_vol.npy ((100, 64, 64), fg=0.0154%)
2025-12-26 16:56:13,951 - INFO - Loaded: week2_d03_h04_w02_vol.npy ((100, 64, 64), fg=0.0142%)
2025-12-26 16:56:13,953 - INFO - Loaded: week2_d03_h04_w03_vol.npy ((100, 64, 64), fg=0.0896%)
2025-12-26 16:56:13,955 - INFO - Loaded: week2_d03_h04_w04_vol.npy ((100, 64, 64), fg=0.0903%)
2025-12-26 16:56:13,957 - INFO - Loaded: week2_d03_h04_w05_vol.npy ((100, 64, 64), fg=0.0771%)
2025-12-26 16:56:13,959 - INFO - Loaded: week2_d03_h04_w06_vol.npy ((100, 64, 64), fg=0.2573%)
2025-12-26 16:56:13,961 - INFO - Loaded: week2_d03_h05_w04_vol.npy ((100, 64, 64), fg=0.1111%)
2025-12-26 16:56:13,963 - INFO - Loaded: week2_d03_h05_w05_vol.npy ((100, 64, 64), fg=0.1348%)
2025-12-26 16:56:13,965 - INFO - Loaded: week2_d03_h05_w06_vol.npy ((100, 64, 64), fg=0.0396%)
2025-12-26 16:56:13,967 - INFO - Loaded: week2_d04_h03_w03_vol.npy ((100, 64, 64), fg=0.5879%)
2025-12-26 16:56:13,969 - INFO - Loaded: week2_d04_h03_w04_vol.npy ((100, 64, 64), fg=0.1567%)
2025-12-26 16:56:13,970 - INFO - Loaded: week2_d04_h04_w03_vol.npy ((100, 64, 64), fg=0.1470%)
2025-12-26 16:56:13,972 - INFO - Loaded: week2_d04_h05_w01_vol.npy ((100, 64, 64), fg=0.0933%)
2025-12-26 16:56:13,974 - INFO - Loaded: week2_d04_h05_w02_vol.npy ((100, 64, 64), fg=0.1001%)
2025-12-26 16:56:13,976 - INFO - Loaded: week2_d04_h05_w03_vol.npy ((100, 64, 64), fg=0.1409%)
2025-12-26 16:56:13,978 - INFO - Loaded: week2_d04_h05_w04_vol.npy ((100, 64, 64), fg=0.0320%)
2025-12-26 16:56:13,980 - INFO - Loaded: week2_d04_h06_w05_vol.npy ((100, 64, 64), fg=0.2107%)
2025-12-26 16:56:13,982 - INFO - Loaded: week2_d05_h02_w03_vol.npy ((100, 64, 64), fg=0.0940%)
2025-12-26 16:56:13,984 - INFO - Loaded: week2_d05_h03_w03_vol.npy ((100, 64, 64), fg=0.4832%)
2025-12-26 16:56:13,986 - INFO - Loaded: week2_d05_h03_w04_vol.npy ((100, 64, 64), fg=0.1453%)
2025-12-26 16:56:13,988 - INFO - Loaded: week2_d05_h04_w00_vol.npy ((100, 64, 64), fg=0.0688%)
2025-12-26 16:56:13,990 - INFO - Loaded: week2_d05_h04_w01_vol.npy ((100, 64, 64), fg=0.0457%)
2025-12-26 16:56:13,992 - INFO - Loaded: week2_d05_h04_w03_vol.npy ((100, 64, 64), fg=0.0171%)
2025-12-26 16:56:13,994 - INFO - Loaded: week2_d05_h05_w00_vol.npy ((100, 64, 64), fg=0.0415%)
2025-12-26 16:56:13,996 - INFO - Loaded: week2_d05_h05_w05_vol.npy ((100, 64, 64), fg=0.0686%)
2025-12-26 16:56:13,998 - INFO - Loaded: week2_d05_h05_w06_vol.npy ((100, 64, 64), fg=0.1067%)
2025-12-26 16:56:14,000 - INFO - Loaded: week2_d05_h06_w05_vol.npy ((100, 64, 64), fg=0.0308%)
2025-12-26 16:56:14,002 - INFO - Loaded: week2_d06_h02_w03_vol.npy ((100, 64, 64), fg=0.0854%)
2025-12-26 16:56:14,004 - INFO - Loaded: week2_d06_h03_w02_vol.npy ((100, 64, 64), fg=0.1641%)
2025-12-26 16:56:14,006 - INFO - Loaded: week2_d06_h03_w03_vol.npy ((100, 64, 64), fg=0.3281%)
2025-12-26 16:56:14,008 - INFO - Loaded: week2_d06_h03_w04_vol.npy ((100, 64, 64), fg=0.3699%)
2025-12-26 16:56:14,010 - INFO - Loaded: week2_d06_h04_w01_vol.npy ((100, 64, 64), fg=0.0771%)
2025-12-26 16:56:14,011 - INFO - Loaded: week2_d06_h04_w02_vol.npy ((100, 64, 64), fg=0.0266%)
2025-12-26 16:56:14,013 - INFO - Loaded: week2_d06_h04_w04_vol.npy ((100, 64, 64), fg=0.0652%)
2025-12-26 16:56:14,015 - INFO - Loaded: week2_d06_h04_w05_vol.npy ((100, 64, 64), fg=0.1646%)
2025-12-26 16:56:14,017 - INFO - Loaded: week2_d06_h04_w06_vol.npy ((100, 64, 64), fg=0.0239%)
2025-12-26 16:56:14,019 - INFO - Loaded: week2_d07_h01_w04_vol.npy ((100, 64, 64), fg=0.0833%)
2025-12-26 16:56:14,021 - INFO - Loaded: week2_d07_h02_w04_vol.npy ((100, 64, 64), fg=0.1670%)
2025-12-26 16:56:14,023 - INFO - Loaded: week2_d07_h03_w04_vol.npy ((100, 64, 64), fg=0.2366%)
2025-12-26 16:56:14,024 - INFO - Loaded: week2_d07_h04_w03_vol.npy ((100, 64, 64), fg=0.6177%)
2025-12-26 16:56:14,025 - INFO - Loaded 53 training subvolumes
2025-12-26 16:56:14,025 - INFO - Loading validation subvolumes from ../data/rapids-p/subvolumes_100x64x64/val
2025-12-26 16:56:14,026 - INFO - Loaded: week2_d06_h05_w06_vol.npy ((100, 64, 64), fg=0.0981%)
2025-12-26 16:56:14,028 - INFO - Loaded: week2_d07_h03_w03_vol.npy ((100, 64, 64), fg=1.2075%)
2025-12-26 16:56:14,028 - INFO - Loaded 2 validation subvolumes
2025-12-26 16:56:14,028 - INFO - Subvolume shape: (100, 64, 64)
2025-12-26 16:56:14,271 - INFO - Model params: 1,927,618
2025-12-26 16:56:15,030 - INFO - Starting training: Namespace(train_dir='../data/rapids-p/subvolumes_100x64x64/train', val_dir='../data/rapids-p/subvolumes_100x64x64/val', epochs=30, slices_per_episode=100, batch_size=32, lr=0.0003, gamma=0.95, buffer_capacity=30000, start_epsilon=1.0, end_epsilon=0.05, warmup_epochs=3, history_len=3, base_channels=32, target_update_every=200, dice_coef=1.0, recall_coef=0.8, precision_coef=0.5, shape_coef=0.3, intensity_coef=0.2, continuity_coef=0.1, boundary_coef=0.2, max_avg_width=6.0, roi_dilation=10, save_dir='dqn_slice_based/models', seed=42)
2025-12-26 16:58:09,981 - INFO - Epoch 1/30 | Loss: 1.3215 | IoU: 0.0061 | Dice: 0.0121 | Prec: 0.0062 | Rec: 0.2300 | CC: 552.5 | Eps: 1.000 | Time: 115.0s
2025-12-26 16:58:09,984 - INFO -   Rewards: dice=0.003, rec=0.773, prec=0.001, shape=0.945, int=0.186, cont=0.995, bound=0.988
2025-12-26 16:58:10,038 - INFO -   New best IoU: 0.0061
2025-12-26 17:00:07,524 - INFO - Epoch 2/30 | Loss: 4.8480 | IoU: 0.0001 | Dice: 0.0002 | Prec: 0.0001 | Rec: 0.0028 | CC: 371.0 | Eps: 1.000 | Time: 116.5s
2025-12-26 17:00:07,526 - INFO -   Rewards: dice=0.003, rec=0.775, prec=0.002, shape=0.945, int=0.186, cont=0.995, bound=0.988
2025-12-26 17:02:02,633 - INFO - Epoch 3/30 | Loss: 7.4256 | IoU: 0.0001 | Dice: 0.0002 | Prec: 0.0001 | Rec: 0.0016 | CC: 305.5 | Eps: 1.000 | Time: 115.1s
2025-12-26 17:02:02,636 - INFO -   Rewards: dice=0.003, rec=0.773, prec=0.001, shape=0.945, int=0.186, cont=0.995, bound=0.988
2025-12-26 17:03:58,820 - INFO - Epoch 4/30 | Loss: 8.0431 | IoU: 0.0003 | Dice: 0.0005 | Prec: 0.0003 | Rec: 0.0143 | CC: 527.5 | Eps: 1.000 | Time: 116.2s
2025-12-26 17:03:58,823 - INFO -   Rewards: dice=0.003, rec=0.775, prec=0.002, shape=0.945, int=0.186, cont=0.995, bound=0.988
2025-12-26 17:05:54,137 - INFO - Epoch 5/30 | Loss: 6.8450 | IoU: 0.0004 | Dice: 0.0008 | Prec: 0.0004 | Rec: 0.0258 | CC: 553.0 | Eps: 0.931 | Time: 115.3s
2025-12-26 17:05:54,140 - INFO -   Rewards: dice=0.003, rec=0.766, prec=0.001, shape=0.935, int=0.190, cont=0.975, bound=0.988
2025-12-26 17:07:49,441 - INFO - Epoch 6/30 | Loss: 5.4038 | IoU: 0.0003 | Dice: 0.0005 | Prec: 0.0003 | Rec: 0.0098 | CC: 719.5 | Eps: 0.864 | Time: 115.3s
2025-12-26 17:07:49,444 - INFO -   Rewards: dice=0.003, rec=0.747, prec=0.001, shape=0.938, int=0.195, cont=0.953, bound=0.988
2025-12-26 17:09:44,755 - INFO - Epoch 7/30 | Loss: 4.4969 | IoU: 0.0013 | Dice: 0.0026 | Prec: 0.0013 | Rec: 0.0269 | CC: 753.0 | Eps: 0.801 | Time: 115.3s
2025-12-26 17:09:44,758 - INFO -   Rewards: dice=0.002, rec=0.731, prec=0.001, shape=0.939, int=0.194, cont=0.936, bound=0.988
2025-12-26 17:11:39,476 - INFO - Epoch 8/30 | Loss: 3.5532 | IoU: 0.0097 | Dice: 0.0191 | Prec: 0.0099 | Rec: 0.3482 | CC: 1288.0 | Eps: 0.739 | Time: 114.7s
2025-12-26 17:11:39,479 - INFO -   Rewards: dice=0.002, rec=0.718, prec=0.001, shape=0.954, int=0.198, cont=0.901, bound=0.988
2025-12-26 17:11:39,538 - INFO -   New best IoU: 0.0097
2025-12-26 17:13:33,647 - INFO - Epoch 9/30 | Loss: 3.2084 | IoU: 0.0102 | Dice: 0.0201 | Prec: 0.0103 | Rec: 0.6301 | CC: 1740.0 | Eps: 0.681 | Time: 114.1s
2025-12-26 17:13:33,650 - INFO -   Rewards: dice=0.003, rec=0.729, prec=0.001, shape=0.923, int=0.190, cont=0.941, bound=0.988
2025-12-26 17:13:33,739 - INFO -   New best IoU: 0.0102
2025-12-26 17:15:28,900 - INFO - Epoch 10/30 | Loss: 2.7057 | IoU: 0.0105 | Dice: 0.0206 | Prec: 0.0105 | Rec: 0.8262 | CC: 2072.0 | Eps: 0.625 | Time: 115.2s
2025-12-26 17:15:28,903 - INFO -   Rewards: dice=0.003, rec=0.817, prec=0.002, shape=0.901, int=0.186, cont=0.966, bound=0.988
2025-12-26 17:15:28,976 - INFO -   New best IoU: 0.0105
2025-12-26 17:17:27,046 - INFO - Epoch 11/30 | Loss: 2.6454 | IoU: 0.0110 | Dice: 0.0216 | Prec: 0.0112 | Rec: 0.5550 | CC: 624.5 | Eps: 0.571 | Time: 117.1s
2025-12-26 17:17:27,049 - INFO -   Rewards: dice=0.004, rec=0.860, prec=0.002, shape=0.912, int=0.187, cont=0.945, bound=0.987
2025-12-26 17:17:27,136 - INFO -   New best IoU: 0.0110
2025-12-26 17:19:19,667 - INFO - Epoch 12/30 | Loss: 2.9387 | IoU: 0.0091 | Dice: 0.0178 | Prec: 0.0092 | Rec: 0.3741 | CC: 666.5 | Eps: 0.520 | Time: 112.5s
2025-12-26 17:19:19,670 - INFO -   Rewards: dice=0.004, rec=0.866, prec=0.002, shape=0.949, int=0.187, cont=0.913, bound=0.988
2025-12-26 17:21:11,663 - INFO - Epoch 13/30 | Loss: 1.8034 | IoU: 0.0087 | Dice: 0.0172 | Prec: 0.0088 | Rec: 0.5970 | CC: 1071.5 | Eps: 0.472 | Time: 112.0s
2025-12-26 17:21:11,666 - INFO -   Rewards: dice=0.003, rec=0.887, prec=0.002, shape=0.791, int=0.186, cont=0.985, bound=0.988
2025-12-26 17:23:01,846 - INFO - Epoch 14/30 | Loss: 2.2466 | IoU: 0.0086 | Dice: 0.0169 | Prec: 0.0087 | Rec: 0.4918 | CC: 2802.5 | Eps: 0.427 | Time: 110.2s
2025-12-26 17:23:01,849 - INFO -   Rewards: dice=0.004, rec=0.883, prec=0.002, shape=0.869, int=0.187, cont=0.960, bound=0.986
2025-12-26 17:24:52,209 - INFO - Epoch 15/30 | Loss: 2.0620 | IoU: 0.0089 | Dice: 0.0176 | Prec: 0.0090 | Rec: 0.5261 | CC: 553.5 | Eps: 0.384 | Time: 110.4s
2025-12-26 17:24:52,212 - INFO -   Rewards: dice=0.004, rec=0.871, prec=0.002, shape=0.944, int=0.186, cont=0.919, bound=0.989
2025-12-26 17:26:42,334 - INFO - Epoch 16/30 | Loss: 2.6968 | IoU: 0.0101 | Dice: 0.0198 | Prec: 0.0102 | Rec: 0.6066 | CC: 279.5 | Eps: 0.343 | Time: 110.1s
2025-12-26 17:26:42,336 - INFO -   Rewards: dice=0.004, rec=0.885, prec=0.002, shape=0.893, int=0.186, cont=0.929, bound=0.989
2025-12-26 17:28:32,823 - INFO - Epoch 17/30 | Loss: 1.8834 | IoU: 0.0075 | Dice: 0.0149 | Prec: 0.0076 | Rec: 0.9380 | CC: 169.5 | Eps: 0.305 | Time: 110.5s
2025-12-26 17:28:32,826 - INFO -   Rewards: dice=0.004, rec=0.881, prec=0.002, shape=0.935, int=0.186, cont=0.933, bound=0.989
2025-12-26 17:30:23,723 - INFO - Epoch 18/30 | Loss: 1.3790 | IoU: 0.0091 | Dice: 0.0180 | Prec: 0.0092 | Rec: 0.8228 | CC: 1874.0 | Eps: 0.270 | Time: 110.9s
2025-12-26 17:30:23,726 - INFO -   Rewards: dice=0.004, rec=0.919, prec=0.002, shape=0.856, int=0.186, cont=0.974, bound=0.988
2025-12-26 17:32:12,367 - INFO - Epoch 19/30 | Loss: 2.1395 | IoU: 0.0095 | Dice: 0.0187 | Prec: 0.0095 | Rec: 0.8711 | CC: 1675.0 | Eps: 0.238 | Time: 108.6s
2025-12-26 17:32:12,370 - INFO -   Rewards: dice=0.004, rec=0.939, prec=0.002, shape=0.718, int=0.186, cont=0.964, bound=0.989
2025-12-26 17:34:00,148 - INFO - Epoch 20/30 | Loss: 1.9066 | IoU: 0.0097 | Dice: 0.0191 | Prec: 0.0097 | Rec: 0.9442 | CC: 1364.5 | Eps: 0.208 | Time: 107.8s
2025-12-26 17:34:00,151 - INFO -   Rewards: dice=0.004, rec=0.951, prec=0.002, shape=0.759, int=0.186, cont=0.966, bound=0.989
2025-12-26 17:35:47,953 - INFO - Epoch 21/30 | Loss: 1.3997 | IoU: 0.0107 | Dice: 0.0211 | Prec: 0.0107 | Rec: 0.9999 | CC: 1188.0 | Eps: 0.180 | Time: 106.9s
2025-12-26 17:35:47,956 - INFO -   Rewards: dice=0.005, rec=0.952, prec=0.002, shape=0.809, int=0.186, cont=0.959, bound=0.988
2025-12-26 17:37:35,566 - INFO - Epoch 22/30 | Loss: 1.3133 | IoU: 0.0106 | Dice: 0.0207 | Prec: 0.0106 | Rec: 0.9962 | CC: 1192.5 | Eps: 0.156 | Time: 107.6s
2025-12-26 17:37:35,569 - INFO -   Rewards: dice=0.005, rec=0.959, prec=0.002, shape=0.864, int=0.186, cont=0.970, bound=0.988
2025-12-26 17:39:25,266 - INFO - Epoch 23/30 | Loss: 0.8626 | IoU: 0.0098 | Dice: 0.0194 | Prec: 0.0098 | Rec: 0.9962 | CC: 582.0 | Eps: 0.133 | Time: 109.7s
2025-12-26 17:39:25,269 - INFO -   Rewards: dice=0.005, rec=0.965, prec=0.002, shape=0.890, int=0.186, cont=0.978, bound=0.989
2025-12-26 17:41:10,613 - INFO - Epoch 24/30 | Loss: 1.3883 | IoU: 0.0123 | Dice: 0.0241 | Prec: 0.0123 | Rec: 1.0000 | CC: 781.5 | Eps: 0.114 | Time: 105.3s
2025-12-26 17:41:10,616 - INFO -   Rewards: dice=0.005, rec=0.963, prec=0.003, shape=0.955, int=0.186, cont=0.958, bound=0.988
2025-12-26 17:41:10,699 - INFO -   New best IoU: 0.0123
2025-12-26 17:42:55,834 - INFO - Epoch 25/30 | Loss: 1.1472 | IoU: 0.0126 | Dice: 0.0246 | Prec: 0.0126 | Rec: 0.9966 | CC: 714.0 | Eps: 0.097 | Time: 105.1s
2025-12-26 17:42:55,837 - INFO -   Rewards: dice=0.005, rec=0.969, prec=0.003, shape=0.953, int=0.186, cont=0.960, bound=0.988
2025-12-26 17:42:55,906 - INFO -   New best IoU: 0.0126
2025-12-26 17:44:40,127 - INFO - Epoch 26/30 | Loss: 1.3575 | IoU: 0.0126 | Dice: 0.0246 | Prec: 0.0126 | Rec: 0.9931 | CC: 1076.5 | Eps: 0.083 | Time: 104.2s
2025-12-26 17:44:40,130 - INFO -   Rewards: dice=0.005, rec=0.969, prec=0.003, shape=0.956, int=0.186, cont=0.962, bound=0.987
2025-12-26 17:44:40,204 - INFO -   New best IoU: 0.0126
2025-12-26 17:46:23,787 - INFO - Epoch 27/30 | Loss: 1.1177 | IoU: 0.0124 | Dice: 0.0243 | Prec: 0.0124 | Rec: 1.0000 | CC: 1136.5 | Eps: 0.071 | Time: 103.6s
2025-12-26 17:46:23,790 - INFO -   Rewards: dice=0.005, rec=0.968, prec=0.003, shape=0.960, int=0.186, cont=0.964, bound=0.988
2025-12-26 17:48:06,781 - INFO - Epoch 28/30 | Loss: 1.3488 | IoU: 0.0119 | Dice: 0.0233 | Prec: 0.0119 | Rec: 1.0000 | CC: 1029.5 | Eps: 0.062 | Time: 103.0s
2025-12-26 17:48:06,784 - INFO -   Rewards: dice=0.005, rec=0.977, prec=0.003, shape=0.950, int=0.186, cont=0.967, bound=0.989
2025-12-26 17:49:49,476 - INFO - Epoch 29/30 | Loss: 1.2290 | IoU: 0.0123 | Dice: 0.0241 | Prec: 0.0123 | Rec: 1.0000 | CC: 982.5 | Eps: 0.055 | Time: 102.7s
2025-12-26 17:49:49,479 - INFO -   Rewards: dice=0.006, rec=0.980, prec=0.003, shape=0.942, int=0.186, cont=0.967, bound=0.987
2025-12-26 17:51:32,510 - INFO - Epoch 30/30 | Loss: 1.9025 | IoU: 0.0104 | Dice: 0.0204 | Prec: 0.0104 | Rec: 1.0000 | CC: 798.0 | Eps: 0.051 | Time: 103.0s
2025-12-26 17:51:32,513 - INFO -   Rewards: dice=0.005, rec=0.984, prec=0.003, shape=0.935, int=0.186, cont=0.972, bound=0.989
2025-12-26 17:51:33,377 - INFO - Training complete. Best IoU: 0.0126
